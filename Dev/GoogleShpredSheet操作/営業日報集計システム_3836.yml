app:
  description: å–¶æ¥­æ—¥å ±ãƒ‡ãƒ¼ã‚¿ã‚’èª­ã¿å–ã‚Šã€LLMã§åˆ†æã—ã¦çµæœã‚’ã‚·ãƒ¼ãƒˆã«æ›¸ãè¾¼ã‚€ã‚·ã‚¹ãƒ†ãƒ 
  icon: ğŸ“Š
  icon_background: '#E0F2FE'
  mode: advanced-chat
  name: å–¶æ¥­æ—¥å ±é›†è¨ˆåˆ†æã‚·ã‚¹ãƒ†ãƒ 
  use_icon_as_answer_icon: false
dependencies:
- current_identifier: null
  type: marketplace
  value:
    marketplace_plugin_unique_identifier: langgenius/google-sheets:1.1.0@25c96f2b47b73962ceeb4dc0c4e963c2e78db9e7c3c3d6cd6bb37d956c4b8a51
kind: app
version: 0.3.0
workflow:
  conversation_variables: []
  environment_variables: []
  features:
    file_upload:
      enabled: false
    opening_statement: å–¶æ¥­æ—¥å ±ã®é›†è¨ˆãƒ»åˆ†æã‚’é–‹å§‹ã—ã¾ã™ã€‚ã‚¹ãƒ—ãƒ¬ãƒƒãƒ‰ã‚·ãƒ¼ãƒˆã®IDã‚’å…¥åŠ›ã—ã¦ãã ã•ã„ã€‚
    retriever_resource:
      enabled: false
    sensitive_word_avoidance:
      enabled: false
    speech_to_text:
      enabled: false
    suggested_questions: []
    suggested_questions_after_answer:
      enabled: false
    text_to_speech:
      enabled: false
      language: ja-JP
      voice: ja-JP-KeitaNeural
  graph:
    edges:
    - data:
        isInLoop: false
        sourceType: start
        targetType: tool
      id: start-source-sheet_reader-target
      markerEnd: none
      selected: false
      source: start
      sourceHandle: source
      target: sheet_reader
      targetHandle: target
      type: custom
      zIndex: 0
    - data:
        isInLoop: false
        sourceType: tool
        targetType: llm
      id: sheet_reader-source-analyzer-target
      markerEnd: none
      selected: false
      source: sheet_reader
      sourceHandle: source
      target: analyzer
      targetHandle: target
      type: custom
      zIndex: 0
    - data:
        isInLoop: false
        sourceType: llm
        targetType: code
      id: analyzer-source-formatter-target
      markerEnd: none
      selected: false
      source: analyzer
      sourceHandle: source
      target: formatter
      targetHandle: target
      type: custom
      zIndex: 0
    - data:
        isInLoop: false
        sourceType: code
        targetType: tool
      id: formatter-source-sheet_writer-target
      markerEnd: none
      selected: false
      source: formatter
      sourceHandle: source
      target: sheet_writer
      targetHandle: target
      type: custom
      zIndex: 0
    - data:
        isInLoop: false
        sourceType: tool
        targetType: answer
      id: sheet_writer-source-answer-target
      markerEnd: none
      selected: false
      source: sheet_writer
      sourceHandle: source
      target: answer
      targetHandle: target
      type: custom
      zIndex: 0
    nodes:
    - data:
        desc: ãƒ¦ãƒ¼ã‚¶ãƒ¼å…¥åŠ›ï¼ˆã‚¹ãƒ—ãƒ¬ãƒƒãƒ‰ã‚·ãƒ¼ãƒˆIDï¼‰ã‚’å—ã‘å–ã‚‹
        selected: false
        title: é–‹å§‹
        type: start
        variables: []
      height: 54
      id: start
      position:
        x: 30
        y: 274
      positionAbsolute:
        x: 30
        y: 274
      selected: false
      sourcePosition: right
      targetPosition: left
      type: custom
      width: 244
    - data:
        provider_id: omluc/google_sheets
        provider_name: marketplace
        provider_type: marketplace
        selected: false
        title: æ—¥å ±ãƒ‡ãƒ¼ã‚¿èª­ã¿å–ã‚Š
        tool_configurations:
          SheetsScopes: 1
        tool_label: Google Sheets
        tool_name: batch_get
        tool_parameters:
          ranges:
            type: mixed
            value: '["æ—¥å ±!A1:E100"]'
          spreadsheet_id:
            type: mixed
            value: '{{#sys.query#}}'
        type: tool
      height: 90
      id: sheet_reader
      position:
        x: 334
        y: 274
      positionAbsolute:
        x: 334
        y: 274
      selected: false
      sourcePosition: right
      targetPosition: left
      type: custom
      width: 244
    - data:
        context:
          enabled: false
          variable_selector: []
        desc: æ—¥å ±ãƒ‡ãƒ¼ã‚¿ã‚’åˆ†æã—ã€é€±æ¬¡ã‚µãƒãƒªãƒ¼ã¨èª²é¡Œã‚’æŠ½å‡º
        model:
          name: gpt-4o-mini
          provider: openai
        prompt_template:
        - id: prompt_1
          role: system
          text: ã‚ãªãŸã¯å–¶æ¥­æ—¥å ±ã‚’åˆ†æã™ã‚‹ã‚¢ãƒŠãƒªã‚¹ãƒˆã§ã™ã€‚æä¾›ã•ã‚ŒãŸæ—¥å ±ãƒ‡ãƒ¼ã‚¿ã‹ã‚‰é€±æ¬¡ã‚µãƒãƒªãƒ¼ã€é‡è¦ãƒã‚¤ãƒ³ãƒˆã€èª²é¡Œã€æ¬¡é€±ã®ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ã‚’æŠ½å‡ºã—ã¦ãã ã•ã„ã€‚
        - id: prompt_2
          role: user
          text: |-
            ä»¥ä¸‹ã®å–¶æ¥­æ—¥å ±ãƒ‡ãƒ¼ã‚¿ã‚’åˆ†æã—ã¦ãã ã•ã„ï¼š

            {{#sheet_reader.result#}}

            ä»¥ä¸‹ã®å½¢å¼ã§åˆ†æçµæœã‚’å‡ºåŠ›ã—ã¦ãã ã•ã„ï¼š

            é€±æ¬¡ã‚µãƒãƒªãƒ¼ï¼š
            [ã“ã“ã«é€±æ¬¡ã‚µãƒãƒªãƒ¼ã‚’è¨˜è¼‰]

            é‡è¦ãƒã‚¤ãƒ³ãƒˆï¼š
            - ãƒã‚¤ãƒ³ãƒˆ1
            - ãƒã‚¤ãƒ³ãƒˆ2
            - ãƒã‚¤ãƒ³ãƒˆ3

            èª²é¡Œï¼š
            - èª²é¡Œ1
            - èª²é¡Œ2
            - èª²é¡Œ3

            æ¬¡é€±ã®ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ï¼š
            - ã‚¢ã‚¯ã‚·ãƒ§ãƒ³1
            - ã‚¢ã‚¯ã‚·ãƒ§ãƒ³2
            - ã‚¢ã‚¯ã‚·ãƒ§ãƒ³3
        selected: false
        structured_output_enabled: false
        title: æ—¥å ±åˆ†æ
        type: llm
        variables: []
        vision:
          enabled: false
      height: 98
      id: analyzer
      position:
        x: 638
        y: 274
      positionAbsolute:
        x: 638
        y: 274
      selected: false
      sourcePosition: right
      targetPosition: left
      type: custom
      width: 244
    - data:
        code: "import json\nimport datetime\n\nanalysis_text = analyzer_text\n\nsections = {\n    'é€±æ¬¡ã‚µãƒãƒªãƒ¼': '',\n    'é‡è¦ãƒã‚¤ãƒ³ãƒˆ': '',\n    'èª²é¡Œ': '',\n    'æ¬¡é€±ã®ã‚¢ã‚¯ã‚·ãƒ§ãƒ³': ''\n}\n\ncurrent_section = None\nfor line in analysis_text.split('\\n'):\n    if 'é€±æ¬¡ã‚µãƒãƒªãƒ¼ï¼š' in line:\n        current_section = 'é€±æ¬¡ã‚µãƒãƒªãƒ¼'\n    elif 'é‡è¦ãƒã‚¤ãƒ³ãƒˆï¼š' in line:\n        current_section = 'é‡è¦ãƒã‚¤ãƒ³ãƒˆ'\n    elif 'èª²é¡Œï¼š' in line:\n        current_section = 'èª²é¡Œ'\n    elif 'æ¬¡é€±ã®ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ï¼š' in line:\n        current_section = 'æ¬¡é€±ã®ã‚¢ã‚¯ã‚·ãƒ§ãƒ³'\n    elif current_section and line.strip():\n        sections[current_section] += line.strip() + ' '\n\ncurrent_time = datetime.datetime.now().strftime('%Y-%m-%d %H:%M:%S')\n\nresult = [{\n    \"range\": \"åˆ†æçµæœ!A1:B6\",\n    \"values\": [\n        [\"é …ç›®\", \"å†…å®¹\"],\n        [\"åˆ†ææ—¥æ™‚\", current_time],\n        [\"é€±æ¬¡ã‚µãƒãƒªãƒ¼\", sections['é€±æ¬¡ã‚µãƒãƒªãƒ¼'].strip()],\n        [\"é‡è¦ãƒã‚¤ãƒ³ãƒˆ\", sections['é‡è¦ãƒã‚¤ãƒ³ãƒˆ'].strip()],\n        [\"èª²é¡Œ\", sections['èª²é¡Œ'].strip()],\n        [\"æ¬¡é€±ã®ã‚¢ã‚¯ã‚·ãƒ§ãƒ³\", sections['æ¬¡é€±ã®ã‚¢ã‚¯ã‚·ãƒ§ãƒ³'].strip()]\n    ]\n}]\n\nresult = json.dumps(result, ensure_ascii=False)"
        code_language: python3
        desc: åˆ†æçµæœã‚’Google Sheetsæ›¸ãè¾¼ã¿ç”¨ã®JSONå½¢å¼ã«å¤‰æ›
        outputs:
          result:
            type: string
        selected: false
        title: çµæœãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆ
        type: code
        variables:
        - value_selector:
          - analyzer
          - text
          variable: analyzer_text
      height: 54
      id: formatter
      position:
        x: 942
        y: 274
      positionAbsolute:
        x: 942
        y: 274
      selected: false
      sourcePosition: right
      targetPosition: left
      type: custom
      width: 244
    - data:
        provider_id: omluc/google_sheets
        provider_name: marketplace
        provider_type: marketplace
        selected: false
        title: åˆ†æçµæœæ›¸ãè¾¼ã¿
        tool_configurations:
          SheetsScopes: 1
        tool_label: Google Sheets
        tool_name: batch_update
        tool_parameters:
          data:
            type: mixed
            value: '{{#formatter.result#}}'
          spreadsheet_id:
            type: mixed
            value: '{{#sys.query#}}'
          value_input_option:
            type: mixed
            value: USER_ENTERED
        type: tool
      height: 90
      id: sheet_writer
      position:
        x: 1246
        y: 274
      positionAbsolute:
        x: 1246
        y: 274
      selected: false
      sourcePosition: right
      targetPosition: left
      type: custom
      width: 244
    - data:
        answer: |-
          å–¶æ¥­æ—¥å ±ã®åˆ†æãŒå®Œäº†ã—ã¾ã—ãŸã€‚

          åˆ†æçµæœã¯ã‚¹ãƒ—ãƒ¬ãƒƒãƒ‰ã‚·ãƒ¼ãƒˆã®ã€Œåˆ†æçµæœã€ã‚·ãƒ¼ãƒˆã«æ›¸ãè¾¼ã¾ã‚Œã¾ã—ãŸã€‚

          {{#analyzer.text#}}
        desc: å‡¦ç†å®Œäº†ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’è¡¨ç¤º
        selected: false
        title: å®Œäº†ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸
        type: answer
      height: 107
      id: answer
      position:
        x: 1550
        y: 274
      positionAbsolute:
        x: 1550
        y: 274
      selected: false
      sourcePosition: right
      targetPosition: left
      type: custom
      width: 244
  hash_id: null