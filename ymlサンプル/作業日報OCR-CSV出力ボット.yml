app:
  description: æ‰‹æ›¸ãä½œæ¥­æ—¥å ±ã®ç”»åƒã‹ã‚‰ä½œæ¥­ãƒ‡ãƒ¼ã‚¿ã‚’èª­ã¿å–ã‚Šã€ç”»åƒã®ãƒ˜ãƒƒãƒ€ãƒ¼æ§‹æˆã®ã¾ã¾CSVãƒ•ã‚¡ã‚¤ãƒ«ã¨ã—ã¦å‡ºåŠ›ã™ã‚‹OCRãƒœãƒƒãƒˆ
  icon: ğŸ“‹
  icon_background: '#3B82F6'
  mode: advanced-chat
  name: ä½œæ¥­æ—¥å ±OCR-CSVå‡ºåŠ›ãƒœãƒƒãƒˆ
  use_icon_as_answer_icon: false
dependencies:
- current_identifier: null
  type: marketplace
  value:
    marketplace_plugin_unique_identifier: langgenius/openai:0.0.26@c1e643ac6a7732f6333a783320b4d3026fa5e31d8e7026375b98d44418d33f26
kind: app
version: 0.3.0
workflow:
  conversation_variables: []
  environment_variables: []
  features:
    file_upload:
      allowed_file_extensions:
      - .JPG
      - .JPEG
      - .PNG
      - .WEBP
      - .HEIC
      - .PDF
      allowed_file_types:
      - image
      - document
      allowed_file_upload_methods:
      - local_file
      enabled: true
      fileUploadConfig:
        audio_file_size_limit: 50
        batch_count_limit: 5
        file_size_limit: 15
        image_file_size_limit: 10
        video_file_size_limit: 100
        workflow_file_upload_limit: 10
      image:
        enabled: false
        number_limits: 5
        transfer_methods:
        - local_file
        - remote_url
      number_limits: 10
    opening_statement: 'ğŸ“‹ ä½œæ¥­æ—¥å ±OCR-CSVå‡ºåŠ›ãƒœãƒƒãƒˆ

      æ‰‹æ›¸ãã®ä½œæ¥­æ—¥å ±ç”»åƒã‚’ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ã™ã‚‹ã¨ã€ç”»åƒã®ãƒ˜ãƒƒãƒ€ãƒ¼æ§‹æˆã®ã¾ã¾CSVãƒ•ã‚¡ã‚¤ãƒ«ã‚’å‡ºåŠ›ã—ã¾ã™ã€‚

      ç”»åƒã‚’ãƒ‰ãƒ©ãƒƒã‚°&ãƒ‰ãƒ­ãƒƒãƒ—ã—ã¦ãã ã•ã„ã€‚'
    retriever_resource:
      enabled: false
    sensitive_word_avoidance:
      enabled: false
    speech_to_text:
      enabled: false
    suggested_questions:
    - CSVå‡ºåŠ›ã™ã‚‹
    suggested_questions_after_answer:
      enabled: false
    text_to_speech:
      enabled: false
      language: ''
      voice: ''
  graph:
    edges:
    - data:
        isInLoop: false
        sourceType: start
        targetType: if-else
      id: start-filecheck-edge
      selected: false
      source: start_node
      sourceHandle: source
      target: file_check_node
      targetHandle: target
      type: custom
      zIndex: 0
    - data:
        isInLoop: false
        sourceType: if-else
        targetType: answer
      id: filecheck-nofile-edge
      selected: false
      source: file_check_node
      sourceHandle: 'true'
      target: no_file_answer
      targetHandle: target
      type: custom
      zIndex: 0
    - data:
        isInLoop: false
        sourceType: if-else
        targetType: llm
      id: filecheck-ocr-edge
      selected: false
      source: file_check_node
      sourceHandle: 'false'
      target: ocr_analysis_node
      targetHandle: target
      type: custom
      zIndex: 0
    - data:
        isInLoop: false
        sourceType: llm
        targetType: code
      id: ocr-csv-edge
      selected: false
      source: ocr_analysis_node
      sourceHandle: source
      target: csv_generation_node
      targetHandle: target
      type: custom
      zIndex: 0
    - data:
        isInLoop: false
        sourceType: code
        targetType: answer
      id: csv-answer-edge
      selected: false
      source: csv_generation_node
      sourceHandle: source
      target: final_answer_node
      targetHandle: target
      type: custom
      zIndex: 0
    nodes:
    - data:
        desc: æ‰‹æ›¸ãä½œæ¥­æ—¥å ±ã®ç”»åƒã‚’ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ã—ã¦ãã ã•ã„ã€‚
        selected: false
        title: é–‹å§‹
        type: start
        variables:
        - allowed_file_extensions:
          - .JPG
          - .JPEG
          - .PNG
          - .WEBP
          - .HEIC
          - .PDF
          allowed_file_types:
          - image
          - document
          allowed_file_upload_methods:
          - local_file
          label: ä½œæ¥­æ—¥å ±ç”»åƒ
          max_length: 10
          options: []
          required: true
          type: file
          variable: work_report_images
      height: 134
      id: start_node
      position:
        x: 50
        y: 100
      positionAbsolute:
        x: 50
        y: 100
      selected: false
      sourcePosition: right
      targetPosition: left
      type: custom
      width: 244
    - data:
        cases:
        - case_id: 'true'
          conditions:
          - comparison_operator: not exists
            id: file_check_condition
            value: ''
            varType: file
            variable_selector:
            - start_node
            - work_report_images
          id: 'true'
          logical_operator: and
        desc: ä½œæ¥­æ—¥å ±ç”»åƒãƒ•ã‚¡ã‚¤ãƒ«ã®å­˜åœ¨ç¢ºèª
        selected: false
        title: ãƒ•ã‚¡ã‚¤ãƒ«å­˜åœ¨ãƒã‚§ãƒƒã‚¯
        type: if-else
      height: 154
      id: file_check_node
      position:
        x: 350
        y: 100
      positionAbsolute:
        x: 350
        y: 100
      selected: false
      sourcePosition: right
      targetPosition: left
      type: custom
      width: 244
    - data:
        answer: 'âŒ ä½œæ¥­æ—¥å ±ã®ç”»åƒãŒã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ã•ã‚Œã¦ã„ã¾ã›ã‚“ã€‚

          ç”»åƒã‚’ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰å¾Œã€ã€ŒCSVå‡ºåŠ›ã™ã‚‹ã€ãƒœã‚¿ãƒ³ã‚’ã‚¯ãƒªãƒƒã‚¯ã—ã¦ãã ã•ã„ã€‚'
        desc: ''
        selected: false
        title: ãƒ•ã‚¡ã‚¤ãƒ«æœªã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰
        type: answer
        variables: []
      height: 150
      id: no_file_answer
      position:
        x: 650
        y: 20.81439075778431
      positionAbsolute:
        x: 650
        y: 20.81439075778431
      selected: false
      sourcePosition: right
      targetPosition: left
      type: custom
      width: 244
    - data:
        context:
          enabled: false
          variable_selector: []
        desc: ç”»åƒã‹ã‚‰OCRã§ãƒ†ã‚­ã‚¹ãƒˆæƒ…å ±ã‚’æŠ½å‡ºã—ã€ç”»åƒã®ãƒ˜ãƒƒãƒ€ãƒ¼æ§‹æˆã®ã¾ã¾CSVå½¢å¼ã§å‡ºåŠ›
        model:
          completion_params: {}
          mode: chat
          name: gpt-4o
          provider: langgenius/openai/openai
        prompt_template:
        - id: system-prompt
          role: system
          text: 'æ‰‹æ›¸ãä½œæ¥­æ—¥å ±ç”»åƒã‚’èª­ã¿å–ã‚Šã€CSVå½¢å¼ã§å‡ºåŠ›ã—ã¦ãã ã•ã„ã€‚

            ç”»åƒã®ãƒ˜ãƒƒãƒ€ãƒ¼è¡Œã‚’ãã®ã¾ã¾ä½¿ç”¨ã—ã€å„ä½œæ¥­ã‚’1è¡Œãšã¤å‡ºåŠ›ã€‚ èª¬æ˜ã¯ä¸è¦ã€CSVãƒ‡ãƒ¼ã‚¿ã®ã¿å‡ºåŠ›ã€‚'
        - id: user-prompt
          role: user
          text: ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ã•ã‚ŒãŸä½œæ¥­æ—¥å ±ç”»åƒã‚’èª­ã¿å–ã‚Šã€CSVå½¢å¼ã§å‡ºåŠ›ã—ã¦ãã ã•ã„ã€‚
        selected: false
        structured_output_enabled: false
        title: OCRç”»åƒè§£æãƒ»CSVå‡ºåŠ›
        type: llm
        variables: []
        vision:
          configs:
            detail: high
            variable_selector: []
          enabled: true
      height: 150
      id: ocr_analysis_node
      position:
        x: 650
        y: 180
      positionAbsolute:
        x: 650
        y: 180
      selected: false
      sourcePosition: right
      targetPosition: left
      type: custom
      width: 244
    - data:
        code: "def main(ocr_result: str) -> dict:\n    \"\"\"\n    OCRçµæœã‚’æ•´å½¢ã—ã¦CSVãƒ•ã‚¡ã‚¤ãƒ«ã‚’ç”Ÿæˆ\n\
          \    \"\"\"\n    from datetime import datetime\n    \n    # OCRçµæœã®æ•´å½¢\n \
          \   csv_content = ocr_result.strip()\n    \n    # è¡Œã®åˆ†å‰²\n    lines = csv_content.split('\\\
          n')\n    \n    # ãƒ‡ãƒ¼ã‚¿è¡Œæ•°ã®ã‚«ã‚¦ãƒ³ãƒˆï¼ˆãƒ˜ãƒƒãƒ€ãƒ¼è¡Œã‚’é™¤ãï¼‰\n    data_lines = []\n    header_found\
          \ = False\n    for i, line in enumerate(lines):\n        if line.strip():\n\
          \            if i == 0 or not header_found:\n                # æœ€åˆã®è¡Œã‚’ãƒ˜ãƒƒãƒ€ãƒ¼ã¨ã—ã¦æ‰±ã†\n\
          \                header_found = True\n            else:\n              \
          \  data_lines.append(line)\n    \n    record_count = len(data_lines)\n \
          \   \n    # ãƒ•ã‚¡ã‚¤ãƒ«åã®ç”Ÿæˆ\n    current_date = datetime.now().strftime(\"%Y%m%d_%H%M%S\"\
          )\n    csv_filename = f\"ä½œæ¥­æ—¥å ±_{current_date}.csv\"\n    \n    return {\n\
          \        \"csv_content\": csv_content,\n        \"csv_filename\": csv_filename,\n\
          \        \"record_count\": record_count,\n        \"processing_status\"\
          : \"æˆåŠŸ\" if record_count > 0 else \"ãƒ‡ãƒ¼ã‚¿ãªã—\"\n    }\n"
        code_language: python3
        desc: CSVç”Ÿæˆå‡¦ç†
        error_strategy: fail-branch
        outputs:
          csv_content:
            children: null
            type: string
          csv_filename:
            children: null
            type: string
          processing_status:
            children: null
            type: string
          record_count:
            children: null
            type: number
        selected: false
        title: CSVç”Ÿæˆå‡¦ç†
        type: code
        variables:
        - value_selector:
          - ocr_analysis_node
          - text
          variable: ocr_result
      height: 118
      id: csv_generation_node
      position:
        x: 950
        y: 180
      positionAbsolute:
        x: 950
        y: 180
      selected: false
      sourcePosition: right
      targetPosition: left
      type: custom
      width: 244
    - data:
        answer: '## âœ… CSVå‡ºåŠ›å®Œäº†


          **ãƒ•ã‚¡ã‚¤ãƒ«å**: {{#csv_generation_node.csv_filename#}}

          **ãƒ‡ãƒ¼ã‚¿ä»¶æ•°**: {{#csv_generation_node.record_count#}}ä»¶

          **å‡¦ç†çŠ¶æ…‹**: {{#csv_generation_node.processing_status#}}


          ### ğŸ“„ CSVãƒ‡ãƒ¼ã‚¿


          ```csv

          {{#csv_generation_node.csv_content#}}

          ```


          ---

          ğŸ’¾ ä¸Šè¨˜ã®CSVãƒ‡ãƒ¼ã‚¿ã‚’ã‚³ãƒ”ãƒ¼ã—ã¦ã€ãƒ†ã‚­ã‚¹ãƒˆã‚¨ãƒ‡ã‚£ã‚¿ã«è²¼ã‚Šä»˜ã‘ã¦ä¿å­˜ã—ã¦ãã ã•ã„ã€‚

          '
        desc: ''
        selected: true
        title: CSVå‡ºåŠ›çµæœ
        type: answer
        variables: []
      height: 270
      id: final_answer_node
      position:
        x: 1250
        y: 180
      positionAbsolute:
        x: 1250
        y: 180
      selected: true
      sourcePosition: right
      targetPosition: left
      type: custom
      width: 244
    viewport:
      x: 108.85924039562553
      y: 117.77570543635505
      zoom: 0.782314569669177
