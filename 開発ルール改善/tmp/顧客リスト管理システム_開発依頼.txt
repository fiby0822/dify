# Dify YMLファイル作成依頼プロンプト

## 要件
Google Spreadsheetsの「顧客リスト」シートを管理するワークフローを作成してください。

### 機能要件：
1. 顧客リストの状況確認
   - 現在の顧客リストを取得して表示
   - 登録されている顧客数をカウント

2. 新規顧客の追加
   - 現在の行数を確認
   - 行数+1行目に新規顧客データを追加
   - 追加データ：顧客名、案件名、金額、ステータス

3. 既存顧客のステータス更新
   - 顧客名を指定
   - その顧客の行を特定
   - ステータスを更新

### シート構造：
- シート名：顧客リスト
- カラム：A列（顧客名）、B列（案件名）、C列（金額）、D列（ステータス）
- ヘッダー行：1行目

### 技術要件：
- version: 0.3.0を使用
- Google Sheets操作にはomluc/google_sheets:0.0.2を使用
- template-transformノードでデータ整形を実施（Jinja2フィルターのスペースに注意）
- Codeノードは使用しない
- IF_ELSEノードで操作種別を判定
- batch_getとbatch_updateの両方を実装

### 重要な注意事項：
- template-transform内では必ず{{ 変数 }}形式を使用（{{#変数#}}は使用禁止）
- Jinja2フィルターは必ずスペースなしで記述：{{ variable|filter }}
- logical_operatorは条件が1つでも必須
- YAMLコメント（#で始まる行）は一切含めない

## アウトプットフォルダパス
/Users/tatsuya/Documents/01_fiby/09_ゼット/Dev/

## 参考資料フォルダパス（あれば）
なし

## コーディングルール
Dify YMLファイルの作成にあたっては、以下のコーディングルールに従ってください：

### 1. 全体コーディングルール
/Users/tatsuya/Documents/01_fiby/09_ゼット/コーディングルール/全体コーディングルール/ 
の全てのルールを参照してください。

### 2. コンポーネント別コーディングルール
各コンポーネントを使用する際は、/Users/tatsuya/Documents/01_fiby/09_ゼット/コーディングルール/コンポーネント別コーディングルール
フォルダ内の使用するコンポーネントについてのtxtファイルを必ず参照してください。

特に以下のファイルを重点的に参照：
- コンポーネント記述ルール_GoogleShpredSheet操作.txt
- コンポーネント記述ルール_IF_ELSE.txt

### 3. 品質チェック
YMLファイル作成後は
/Users/tatsuya/Documents/01_fiby/09_ゼット/コーディングルール/品質チェック/品質チェックリスト.md
/Users/tatsuya/Documents/01_fiby/09_ゼット/コーディングルール/品質チェック/クラッシュ事項チェックリスト.md
/Users/tatsuya/Documents/01_fiby/09_ゼット/コーディングルール/品質チェック/コードチェック.md
/Users/tatsuya/Documents/01_fiby/09_ゼット/コーディングルール/品質チェック/エラー事例集.md
を参照し、必ずセルフレビューを実施してください。チェックに引っかかった場合は、ymlファイルを改修すること。

### template-transformノードに関する重要な注意事項

template-transformノードを使用する場合、以下の記法ルールを必ず守ってください：

1. **変数参照は{{ 変数名 }}形式のみ使用**
   - ❌ 間違い: {{#変数名#}}
   - ✅ 正解: {{ 変数名 }}

2. **フィルター使用時も同様**
   - ❌ 間違い: {{#変数 | trim | tojson#}}
   - ✅ 正解: {{ 変数 | trim | tojson }}

3. **Google Sheetsデータの参照**
   - batch_get出力は配列形式
   - 必ず[0]でアクセス: sheet_data[0].values

これらのルールを守らないと、実行時にクラッシュします。

### 最頻出エラーの回避
1. **Jinja2フィルターのスペース（エラー率30%）**
   - ❌ 間違い: {{ row | join(',') }}
   - ✅ 正解: {{ row|join(',') }}

2. **logical_operator欠落（エラー率20%）**
   - 全てのIF_ELSEケースに必ずlogical_operator: andまたはorを設定

3. **Google Sheetsデータパス（エラー率15%）**
   - 正しいパス: sheet_data[0]["valueRanges"][0]["values"]
   - ブラケット記法を使用（ドット記法は使用禁止）