# Dify YMLファイル作成依頼プロンプト

## 要件
画像ファイルからOCRまたは画像認識を行うワークフローを作成してください。
以下の機能を実装すること：

1. 画像ファイルのアップロード受付（JPG, PNG, WEBP, PDF等対応）
2. LLMのVision機能（gpt-4o）を使用した高精度なOCR・画像認識
3. 認識結果の構造化出力（テキスト抽出、物体認識、表データのCSV変換など）
4. 日本語文字認識への最適化（手書き文字対応）
5. エラーハンドリング（ファイル形式チェック、サイズチェック）
6. ユーザーが選択できる複数の処理モード
   - OCRモード：画像内のテキストを抽出
   - 画像分析モード：画像の内容を説明
   - 表データ抽出モード：表形式データをCSV形式で出力

注意事項：
- Codeノードは使用しないこと
- LLMノードのvision機能を有効化すること（vision.enabled: true）
- detail設定は"high"を使用すること
- version: 0.3.0 を必ず使用すること

## アウトプットフォルダパス
/Users/tatsuya/Documents/01_fiby/09_ゼット/Dev/

## 参考資料フォルダパス（あれば）
なし

## コーディングルール
Dify YMLファイルの作成にあたっては、以下のコーディングルールに従ってください：

### 1. 全体コーディングルール
/Users/tatsuya/Documents/01_fiby/09_ゼット/コーディングルール/全体コーディングルール/ 
の全てのルールを参照してください。

### 2. コンポーネント別コーディングルール
各コンポーネントを使用する際は、/Users/tatsuya/Documents/01_fiby/09_ゼット/コーディングルール/コンポーネント別コーディングルール
フォルダ内の使用するコンポーネントについてのtxtファイルを必ず参照してください。

特に以下のファイルを重点的に参照すること：
- コンポーネント記述ルール_画像認識.txt
- コンポーネント記述ルール_LLM.txt

### 3. 品質チェック
YMLファイル作成後は
/Users/tatsuya/Documents/01_fiby/09_ゼット/コーディングルール/品質チェック/品質チェックリスト.md
/Users/tatsuya/Documents/01_fiby/09_ゼット/コーディングルール/品質チェック/クラッシュ事項チェックリスト.md
/Users/tatsuya/Documents/01_fiby/09_ゼット/コーディングルール/品質チェック/コードチェック.md
/Users/tatsuya/Documents/01_fiby/09_ゼット/コーディングルール/品質チェック/エラー事例集.md
を参照し、必ずセルフレビューを実施してください。チェックに引っかかった場合は、ymlファイルを改修すること。

### template-transformノードに関する重要な注意事項

template-transformノードを使用する場合、以下の記法ルールを必ず守ってください：

1. **変数参照は{{ 変数名 }}形式のみ使用**
   - ❌ 間違い: {{#変数名#}}
   - ✅ 正解: {{ 変数名 }}

2. **フィルター使用時も同様**
   - ❌ 間違い: {{#変数 | trim | tojson#}}
   - ✅ 正解: {{ 変数 | trim | tojson }}

3. **Google Sheetsデータの参照**
   - batch_get出力は配列形式
   - 必ず[0]でアクセス: sheet_data[0].values

これらのルールを守らないと、実行時にクラッシュします。