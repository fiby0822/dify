# Dify YML作成依頼

## 1. 要件

### ワークフロー名
音声・画像認識統合処理ワークフロー

### ワークフローの目的
音声ファイルまたは画像ファイルを入力として受け取り、ファイルタイプに応じて適切な認識処理を実行し、結果をGoogle Sheetsに記録した後、ユーザーに返すワークフロー

### 詳細要件
1. **開始ノード**
   - ファイル入力（file）を受け付ける
   - ファイル名（file_name）も入力として受け取る

2. **ファイルタイプ判定**
   - IFノードを使用してファイルタイプを判定
   - 音声ファイル（.mp3, .wav, .m4a）か画像ファイル（.jpg, .png, .pdf）かを判定

3. **音声処理ブランチ**
   - OpenAI Audio STT（音声認識）ノードを使用
   - モデル：gpt-4o-transcribe（ストリーミング対応）
   - 音声を文字起こし

4. **画像処理ブランチ**
   - LLMノード（Vision機能有効）を使用
   - モデル：gpt-4o
   - プロンプト：「この画像に何が写っていますか？詳細に説明してください。」

5. **結果整形**
   - Template Transformノードで結果を整形
   - 処理タイプ（音声/画像）、入力ファイル名、認識結果を含む

6. **Google Sheets記録**
   - 処理日時、ファイル名、処理タイプ、認識結果を記録
   - シート名：「認識処理ログ」

7. **終了ノード**
   - 処理結果をユーザーに返す
   - 成功/失敗のステータスも含める

### バージョン
version: 0.3.0（必須）

### 制約事項
- Codeノードは使用しない
- すべての変数参照は{{ 変数名 }}形式で記述
- Google Sheetsデータは配列形式でアクセス（[0]使用）

## 2. 作成するYMLファイル名
音声画像認識検証ワークフロー.yml

## 3. 出力先
/Users/tatsuya/Documents/01_fiby/09_ゼット/Dev/

## 4. 参考にしてほしい資料
/Users/tatsuya/Documents/01_fiby/09_ゼット/ymlサンプル/

## 5. 必ず参照するコーディングルール

### 全体コーディングルール
- /Users/tatsuya/Documents/01_fiby/09_ゼット/コーディングルール/Dify_YML_コーディングルール.txt
- /Users/tatsuya/Documents/01_fiby/09_ゼット/コーディングルール/TEMPLATE_TRANSFORM_エラー対策強化版.txt

### コンポーネント別コーディングルール
- /Users/tatsuya/Documents/01_fiby/09_ゼット/コーディングルール/コンポーネント別コーディングルール/コンポーネント記述ルール_音声認識.txt
- /Users/tatsuya/Documents/01_fiby/09_ゼット/コーディングルール/コンポーネント別コーディングルール/コンポーネント記述ルール_画像認識.txt

### 品質チェック（YMLファイル作成後に必ず実施）
- /Users/tatsuya/Documents/01_fiby/09_ゼット/コーディングルール/品質チェック/品質チェックリスト.md
- /Users/tatsuya/Documents/01_fiby/09_ゼット/コーディングルール/品質チェック/クラッシュ事項チェックリスト.md
- /Users/tatsuya/Documents/01_fiby/09_ゼット/コーディングルール/品質チェック/コードチェック.md
- /Users/tatsuya/Documents/01_fiby/09_ゼット/コーディングルール/品質チェック/エラー事例集.md

## 備考
このワークフローは音声認識と画像認識の新しいコーディングルールの検証を目的としています。特に以下の点に注意してください：
- 音声認識ノードのmarketplaceプラグイン設定
- 画像認識（Vision）の正しい設定
- dependencies定義の正確性
- template-transformでの変数参照形式