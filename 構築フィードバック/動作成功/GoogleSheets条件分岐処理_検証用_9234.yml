app:
  description: Google Sheetsã®èª­ã¿è¾¼ã¿ãƒ»æ›¸ãè¾¼ã¿ã‚’æ¡ä»¶åˆ†å²ã§åˆ¶å¾¡ã™ã‚‹ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼ã§ã™ã€‚æ“ä½œã‚¿ã‚¤ãƒ—ã«å¿œã˜ã¦é©åˆ‡ãªå‡¦ç†ã‚’å®Ÿè¡Œã—ã¾ã™ã€‚
  icon: ğŸ“Š
  icon_background: '#E1F5FE'
  mode: advanced-chat
  name: GoogleSheetsæ¡ä»¶åˆ†å²å‡¦ç†ãƒ„ãƒ¼ãƒ«
  use_icon_as_answer_icon: false
dependencies:
  - current_identifier: null
    type: marketplace
    value:
      marketplace_plugin_unique_identifier: omluc/google_sheets:0.0.2@17f06eaa1d905595e1a76460e7249707a722142353d551cf14aed3d8517c134f
kind: app
version: 0.3.0
workflow:
  conversation_variables: []
  environment_variables: []
  features:
    file_upload:
      custom_config:
        file_size_limit: 15
        number_limits: 5
      enabled: false
    opening_statement: "Google Sheetsã®èª­ã¿è¾¼ã¿ãƒ»æ›¸ãè¾¼ã¿ãƒ„ãƒ¼ãƒ«ã§ã™ã€‚\n\nä½¿ç”¨æ–¹æ³•ï¼š\n1. æ“ä½œã‚¿ã‚¤ãƒ—ã‚’é¸æŠï¼ˆread: èª­ã¿è¾¼ã¿ã€write: æ›¸ãè¾¼ã¿ï¼‰\n2. Google Sheetsã®URLã‚’å…¥åŠ›\n3. æ“ä½œå¯¾è±¡ã®ç¯„å›²ã‚’æŒ‡å®šï¼ˆä¾‹ï¼šA1:C10ï¼‰\n4. æ›¸ãè¾¼ã¿ã®å ´åˆã¯ã€ãƒ‡ãƒ¼ã‚¿ã‚’JSONå½¢å¼ã§å…¥åŠ›\n\nä¾‹ï¼š\n- èª­ã¿è¾¼ã¿: operation_type=read, range=A1:C10\n- æ›¸ãè¾¼ã¿: operation_type=write, range=A1:B2, data=[[\"é …ç›®\",\"å€¤\"],[\"ãƒ‡ãƒ¼ã‚¿1\",\"100\"]]"
    retriever_resource:
      enabled: false
    sensitive_word_avoidance:
      enabled: false
    speech_to_text:
      enabled: false
    suggested_questions:
      - ã‚·ãƒ¼ãƒˆã‹ã‚‰A1:C10ã®ç¯„å›²ã®ãƒ‡ãƒ¼ã‚¿ã‚’èª­ã¿è¾¼ã¿ãŸã„
      - ã‚·ãƒ¼ãƒˆã®A1:B2ã«æ–°ã—ã„ãƒ‡ãƒ¼ã‚¿ã‚’æ›¸ãè¾¼ã¿ãŸã„
      - èª­ã¿è¾¼ã¿ã¨æ›¸ãè¾¼ã¿ã®ä½¿ã„åˆ†ã‘ã‚’æ•™ãˆã¦
    text_to_speech:
      enabled: false
      language: ''
      voice: ''
  graph:
    edges:
      - data:
          isInLoop: false
          sourceType: start
          targetType: llm
        id: edge_start_to_parse
        selected: false
        source: start_node
        sourceHandle: source
        target: parse_input_node
        targetHandle: target
        type: custom
        zIndex: 0
      - data:
          isInLoop: false
          sourceType: llm
          targetType: if-else
        id: edge_parse_to_condition
        selected: false
        source: parse_input_node
        sourceHandle: source
        target: operation_type_check
        targetHandle: target
        type: custom
        zIndex: 0
      - data:
          isInLoop: false
          sourceType: if-else
          targetType: tool
        id: edge_condition_to_read
        selected: false
        source: operation_type_check
        sourceHandle: read_case
        target: google_sheets_read
        targetHandle: target
        type: custom
        zIndex: 0
      - data:
          isInLoop: false
          sourceType: if-else
          targetType: template-transform
        id: edge_condition_to_transform
        selected: false
        source: operation_type_check
        sourceHandle: write_case
        target: transform_write_data
        targetHandle: target
        type: custom
        zIndex: 0
      - data:
          isInLoop: false
          sourceType: template-transform
          targetType: tool
        id: edge_transform_to_write
        selected: false
        source: transform_write_data
        sourceHandle: source
        target: google_sheets_write
        targetHandle: target
        type: custom
        zIndex: 0
      - data:
          isInLoop: false
          sourceType: tool
          targetType: template-transform
        id: edge_read_to_format
        selected: false
        source: google_sheets_read
        sourceHandle: source
        target: format_read_result
        targetHandle: target
        type: custom
        zIndex: 0
      - data:
          isInLoop: false
          sourceType: tool
          targetType: template-transform
        id: edge_write_to_format
        selected: false
        source: google_sheets_write
        sourceHandle: source
        target: format_write_result
        targetHandle: target
        type: custom
        zIndex: 0
      - data:
          isInLoop: false
          sourceType: template-transform
          targetType: answer
        id: edge_format_read_to_answer
        selected: false
        source: format_read_result
        sourceHandle: source
        target: answer_node
        targetHandle: target
        type: custom
        zIndex: 0
      - data:
          isInLoop: false
          sourceType: template-transform
          targetType: answer
        id: edge_format_write_to_answer
        selected: false
        source: format_write_result
        sourceHandle: source
        target: answer_node
        targetHandle: target
        type: custom
        zIndex: 0
      - data:
          isInLoop: false
          sourceType: if-else
          targetType: answer
        id: edge_condition_to_error
        selected: false
        source: operation_type_check
        sourceHandle: "false"
        target: error_answer_node
        targetHandle: target
        type: custom
        zIndex: 0
    nodes:
      - data:
          desc: ''
          selected: false
          title: é–‹å§‹
          type: start
          variables: []
        height: 90
        id: start_node
        position:
          x: 50
          y: 200
        positionAbsolute:
          x: 50
          y: 200
        selected: false
        sourcePosition: right
        targetPosition: left
        type: custom
        width: 244
      - data:
          type: llm
          title: å…¥åŠ›è§£æ
          desc: ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®å…¥åŠ›ã‚’è§£æã—ã€å¿…è¦ãªãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã‚’æŠ½å‡º
          variables: []
          model:
            provider: openai
            name: gpt-4o
            mode: chat
            completion_params:
              temperature: 0.3
              max_tokens: 1000
              top_p: 0.7
              frequency_penalty: 0
              presence_penalty: 0
          prompt_template:
            - id: system_prompt
              role: system
              text: |
                ã‚ãªãŸã¯Google Sheetsæ“ä½œãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã‚’æŠ½å‡ºã™ã‚‹å°‚é–€å®¶ã§ã™ã€‚
                ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®å…¥åŠ›ã‹ã‚‰ä»¥ä¸‹ã®æƒ…å ±ã‚’æŠ½å‡ºã—ã¦ãã ã•ã„ï¼š
                
                1. operation_type: "read"ï¼ˆèª­ã¿è¾¼ã¿ï¼‰ã¾ãŸã¯"write"ï¼ˆæ›¸ãè¾¼ã¿ï¼‰
                2. sheet_url: Google Sheetsã®URLï¼ˆå®Œå…¨ãªURLï¼‰
                3. range: æ“ä½œå¯¾è±¡ã®ç¯„å›²ï¼ˆä¾‹ï¼šA1:C10, Sheet1!A1:B5ï¼‰
                4. data: æ›¸ãè¾¼ã¿æ™‚ã®ãƒ‡ãƒ¼ã‚¿ï¼ˆwriteã®å ´åˆã®ã¿ã€JSONé…åˆ—å½¢å¼ï¼‰
                
                å‡ºåŠ›å½¢å¼ï¼ˆJSONï¼‰ï¼š
                {
                  "operation_type": "read/write",
                  "spreadsheet_id": "æŠ½å‡ºã—ãŸã‚¹ãƒ—ãƒ¬ãƒƒãƒ‰ã‚·ãƒ¼ãƒˆID",
                  "range": "ç¯„å›²",
                  "data": [[...]] // writeã®å ´åˆã®ã¿
                }
                
                æ³¨æ„ï¼š
                - URLã‹ã‚‰ã‚¹ãƒ—ãƒ¬ãƒƒãƒ‰ã‚·ãƒ¼ãƒˆIDã‚’æŠ½å‡ºï¼ˆ/d/ã¨/editã®é–“ã®44æ–‡å­—ï¼‰
                - rangeã«ã‚·ãƒ¼ãƒˆåãŒå«ã¾ã‚Œãªã„å ´åˆã¯ã€ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã§Sheet1ã‚’ä½¿ç”¨
                - dataã¯å¿…ãš2æ¬¡å…ƒé…åˆ—å½¢å¼ã§å‡ºåŠ›
            - id: user_prompt
              role: user
              text: "{{#sys.query#}}"
          selected: false
          context:
            enabled: false
            variable_selector: []
          vision:
            enabled: false
          structured_output_enabled: false
        height: 98
        id: parse_input_node
        position:
          x: 350
          y: 200
        positionAbsolute:
          x: 350
          y: 200
        selected: false
        sourcePosition: right
        targetPosition: left
        type: custom
        width: 244
      - data:
          type: if-else
          title: æ“ä½œã‚¿ã‚¤ãƒ—åˆ¤å®š
          desc: readã¾ãŸã¯writeã®åˆ¤å®š
          cases:
            - id: read_case
              case_id: read_case
              conditions:
                - id: read_condition
                  variable_selector:
                    - parse_input_node
                    - text
                  comparison_operator: contains
                  value: '"operation_type": "read"'
              logical_operator: and
            - id: write_case
              case_id: write_case
              conditions:
                - id: write_condition
                  variable_selector:
                    - parse_input_node
                    - text
                  comparison_operator: contains
                  value: '"operation_type": "write"'
              logical_operator: and
          selected: false
        height: 154
        id: operation_type_check
        position:
          x: 650
          y: 200
        positionAbsolute:
          x: 650
          y: 200
        selected: false
        sourcePosition: right
        targetPosition: left
        type: custom
        width: 244
      - data:
          type: tool
          provider_id: omluc/google_sheets/google_sheets
          provider_name: omluc/google_sheets/google_sheets
          provider_type: builtin
          tool_label: Batch Get
          tool_name: batch_get
          tool_description: Retrieve data from multiple ranges in a Google Sheet
          is_team_authorization: true
          output_schema: null
          tool_configurations:
            date_time_render_option: FORMATTED_STRING
            major_dimension: null
            value_render_option: null
          tool_parameters:
            ranges:
              type: mixed
              value: '{{#parse_input_node.text|fromjson|attr("range")|default("Sheet1!A1:A1")|list|tojson#}}'
            spreadsheet_id:
              type: mixed
              value: '{{#parse_input_node.text|fromjson|attr("spreadsheet_id")|default("")#}}'
          selected: false
          title: ã‚·ãƒ¼ãƒˆã‹ã‚‰ãƒ‡ãƒ¼ã‚¿èª­ã¿è¾¼ã¿
          desc: Google Sheetsã‹ã‚‰ãƒ‡ãƒ¼ã‚¿ã‚’å–å¾—
        height: 90
        id: google_sheets_read
        position:
          x: 950
          y: 100
        positionAbsolute:
          x: 950
          y: 100
        selected: false
        sourcePosition: right
        targetPosition: left
        type: custom
        width: 244
      - data:
          type: template-transform
          title: æ›¸ãè¾¼ã¿ãƒ‡ãƒ¼ã‚¿æ•´å½¢
          desc: æ›¸ãè¾¼ã¿ç”¨ãƒ‡ãƒ¼ã‚¿ã‚’JSONå½¢å¼ã«æ•´å½¢
          template: |
            {% set parsed_data = input_data|fromjson|default({}) %}
            {% if parsed_data.data %}
            [{
              "range": "{{ parsed_data.range|default('Sheet1!A1') }}",
              "values": {{ parsed_data.data|tojson }}
            }]
            {% else %}
            [{
              "range": "Sheet1!A1:B2",
              "values": [["ã‚¨ãƒ©ãƒ¼", "ãƒ‡ãƒ¼ã‚¿ãŒæŒ‡å®šã•ã‚Œã¦ã„ã¾ã›ã‚“"]]
            }]
            {% endif %}
          variables:
            - value_selector:
                - parse_input_node
                - text
              value_type: object
              variable: input_data
          selected: false
        height: 54
        id: transform_write_data
        position:
          x: 950
          y: 250
        positionAbsolute:
          x: 950
          y: 250
        selected: false
        sourcePosition: right
        targetPosition: left
        type: custom
        width: 244
      - data:
          type: tool
          provider_id: omluc/google_sheets/google_sheets
          provider_name: omluc/google_sheets/google_sheets
          provider_type: builtin
          tool_label: Batch Update
          tool_name: batch_update
          tool_description: Updates multiple ranges in a Google Sheet with specified values
          is_team_authorization: true
          output_schema: null
          tool_configurations:
            include_values_in_response: null
            response_date_time_render_option: null
            response_value_render_option: null
            value_input_option: USER_ENTERED
          tool_parameters:
            data:
              type: mixed
              value: '{{#transform_write_data.output#}}'
            spreadsheet_id:
              type: mixed
              value: '{{#parse_input_node.text|fromjson|attr("spreadsheet_id")|default("")#}}'
          selected: false
          title: ã‚·ãƒ¼ãƒˆã¸ãƒ‡ãƒ¼ã‚¿æ›¸ãè¾¼ã¿
          desc: Google Sheetsã«ãƒ‡ãƒ¼ã‚¿ã‚’æ›¸ãè¾¼ã¿
        height: 90
        id: google_sheets_write
        position:
          x: 1250
          y: 250
        positionAbsolute:
          x: 1250
          y: 250
        selected: false
        sourcePosition: right
        targetPosition: left
        type: custom
        width: 244
      - data:
          type: template-transform
          title: èª­ã¿è¾¼ã¿çµæœæ•´å½¢
          desc: èª­ã¿è¾¼ã‚“ã ãƒ‡ãƒ¼ã‚¿ã‚’è¦‹ã‚„ã™ãæ•´å½¢
          template: |
            ## èª­ã¿è¾¼ã¿çµæœ
            
            æ“ä½œ: ãƒ‡ãƒ¼ã‚¿èª­ã¿è¾¼ã¿å®Œäº†
            
            {% if sheet_data and sheet_data[0] and sheet_data[0].values %}
            å–å¾—ãƒ‡ãƒ¼ã‚¿ï¼ˆ{{ sheet_data[0].values|length }}è¡Œï¼‰ï¼š
            
            {% for row in sheet_data[0].values %}
            {{ loop.index }}. {{ row|join(' | ') }}
            {% endfor %}
            {% else %}
            æŒ‡å®šã•ã‚ŒãŸç¯„å›²ã«ãƒ‡ãƒ¼ã‚¿ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“ã§ã—ãŸã€‚
            {% endif %}
          variables:
            - value_selector:
                - google_sheets_read
                - json
              value_type: array[object]
              variable: sheet_data
          selected: false
        height: 54
        id: format_read_result
        position:
          x: 1250
          y: 100
        positionAbsolute:
          x: 1250
          y: 100
        selected: false
        sourcePosition: right
        targetPosition: left
        type: custom
        width: 244
      - data:
          type: template-transform
          title: æ›¸ãè¾¼ã¿çµæœæ•´å½¢
          desc: æ›¸ãè¾¼ã¿å®Œäº†ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’ç”Ÿæˆ
          template: |
            ## æ›¸ãè¾¼ã¿çµæœ
            
            æ“ä½œ: ãƒ‡ãƒ¼ã‚¿æ›¸ãè¾¼ã¿å®Œäº†
            
            Google Sheetsã¸ã®ãƒ‡ãƒ¼ã‚¿æ›¸ãè¾¼ã¿ãŒæ­£å¸¸ã«å®Œäº†ã—ã¾ã—ãŸã€‚
            
            æ›´æ–°æƒ…å ±ï¼š
            - æ›´æ–°ç¯„å›²: {{ update_info.updatedRange|default('ä¸æ˜') }}
            - æ›´æ–°ã‚»ãƒ«æ•°: {{ update_info.updatedCells|default(0) }}
            - æ›´æ–°è¡Œæ•°: {{ update_info.updatedRows|default(0) }}
            - æ›´æ–°åˆ—æ•°: {{ update_info.updatedColumns|default(0) }}
          variables:
            - value_selector:
                - google_sheets_write
                - json
              value_type: object
              variable: update_info
          selected: false
        height: 54
        id: format_write_result
        position:
          x: 1550
          y: 250
        positionAbsolute:
          x: 1550
          y: 250
        selected: false
        sourcePosition: right
        targetPosition: left
        type: custom
        width: 244
      - data:
          type: answer
          title: å‡¦ç†çµæœ
          desc: ''
          answer: '{{#format_read_result.output#}}{{#format_write_result.output#}}'
          selected: false
        height: 107
        id: answer_node
        position:
          x: 1850
          y: 175
        positionAbsolute:
          x: 1850
          y: 175
        selected: false
        sourcePosition: right
        targetPosition: left
        type: custom
        width: 244
      - data:
          type: answer
          title: ã‚¨ãƒ©ãƒ¼
          desc: ''
          answer: |
            ã‚¨ãƒ©ãƒ¼: ç„¡åŠ¹ãªæ“ä½œã‚¿ã‚¤ãƒ—ãŒæŒ‡å®šã•ã‚Œã¾ã—ãŸã€‚
            
            æ­£ã—ã„ä½¿ç”¨æ–¹æ³•ï¼š
            1. operation_typeã«"read"ã¾ãŸã¯"write"ã‚’æŒ‡å®šã—ã¦ãã ã•ã„
            2. sheet_urlã«Google Sheetsã®URLã‚’å…¥åŠ›ã—ã¦ãã ã•ã„
            3. rangeã«æ“ä½œå¯¾è±¡ã®ç¯„å›²ã‚’æŒ‡å®šã—ã¦ãã ã•ã„ï¼ˆä¾‹ï¼šA1:C10ï¼‰
            4. writeã®å ´åˆã¯ã€dataã«JSONå½¢å¼ã®2æ¬¡å…ƒé…åˆ—ã‚’æŒ‡å®šã—ã¦ãã ã•ã„
            
            ä¾‹ï¼š
            - èª­ã¿è¾¼ã¿: "A1:C10ã®ç¯„å›²ã‚’èª­ã¿è¾¼ã¿ãŸã„"
            - æ›¸ãè¾¼ã¿: "A1:B2ã«[["é …ç›®","å€¤"],["ãƒ‡ãƒ¼ã‚¿1","100"]]ã‚’æ›¸ãè¾¼ã¿ãŸã„"
          selected: false
        height: 107
        id: error_answer_node
        position:
          x: 950
          y: 400
        positionAbsolute:
          x: 950
          y: 400
        selected: false
        sourcePosition: right
        targetPosition: left
        type: custom
        width: 244