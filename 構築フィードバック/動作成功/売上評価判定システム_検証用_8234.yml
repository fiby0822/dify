app:
  description: "Google Sheetsã‹ã‚‰å–¶æ¥­å“¡ã®å£²ä¸Šãƒ‡ãƒ¼ã‚¿ã‚’èª­ã¿å–ã‚Šã€é‡‘é¡ã«å¿œã˜ã¦è©•ä¾¡åˆ¤å®šã‚’è¡Œã„ã€çµæœã‚’RESULTã‚·ãƒ¼ãƒˆã«æ›¸ãè¾¼ã‚€ã‚·ã‚¹ãƒ†ãƒ ã§ã™ã€‚"
  icon: "ğŸ“Š"
  icon_background: "#FFEAD5"
  mode: advanced-chat
  name: "å£²ä¸Šè©•ä¾¡åˆ¤å®šã‚·ã‚¹ãƒ†ãƒ "
  use_icon_as_answer_icon: false

dependencies:
- current_identifier: null
  type: marketplace
  value:
    marketplace_plugin_unique_identifier: omluc/google_sheets:0.0.2@17f06eaa1d905595e1a76460e7249707a722142353d551cf14aed3d8517c134f

kind: app

version: 0.3.0

workflow:
  conversation_variables: []
  environment_variables: []
  features:
    file_upload:
      enabled: false
    retriever_resource:
      enabled: false
    sensitive_word_avoidance:
      enabled: false
    speech_to_text:
      enabled: false
    suggested_questions_after_answer:
      enabled: false
    text_to_speech:
      enabled: false
    opening_statement: "å£²ä¸Šè©•ä¾¡åˆ¤å®šã‚·ã‚¹ãƒ†ãƒ ã¸ã‚ˆã†ã“ãï¼\n\nGoogle Sheetsã‹ã‚‰å–¶æ¥­å“¡ã®å£²ä¸Šãƒ‡ãƒ¼ã‚¿ã‚’èª­ã¿å–ã‚Šã€è©•ä¾¡åˆ¤å®šã‚’è¡Œã„ã¾ã™ã€‚\nè©•ä¾¡åŸºæº–ï¼š\n- 1000ä¸‡å††ä»¥ä¸Šï¼šé«˜è©•ä¾¡\n- 500ä¸‡å††ä»¥ä¸Š1000ä¸‡å††æœªæº€ï¼šä¸­è©•ä¾¡\n- 500ä¸‡å††æœªæº€ï¼šä½è©•ä¾¡\n\nå‡¦ç†ã‚’é–‹å§‹ã™ã‚‹ã«ã¯ã€Google Sheetsã®IDã‚’å…¥åŠ›ã—ã¦ãã ã•ã„ã€‚"
    suggested_questions:
      - "1dd5IPZBYY5ZtImb48SLnO8c9b4Z8w5YUr1gWF0STqSQ"
  graph:
    edges:
      - data:
          isInLoop: false
          sourceType: start
          targetType: tool
        id: start-sheets_read-edge
        selected: false
        source: start_node
        sourceHandle: source
        target: sheets_read_node
        targetHandle: target
        type: custom
        zIndex: 0
      - data:
          isInLoop: false
          sourceType: tool
          targetType: template-transform
        id: sheets_read-transform_data-edge
        selected: false
        source: sheets_read_node
        sourceHandle: source
        target: transform_data_node
        targetHandle: target
        type: custom
        zIndex: 0
      - data:
          isInLoop: false
          sourceType: template-transform
          targetType: llm
        id: transform_data-llm_analyzer-edge
        selected: false
        source: transform_data_node
        sourceHandle: source
        target: llm_analyzer_node
        targetHandle: target
        type: custom
        zIndex: 0
      - data:
          isInLoop: false
          sourceType: llm
          targetType: template-transform
        id: llm_analyzer-prepare_update-edge
        selected: false
        source: llm_analyzer_node
        sourceHandle: source
        target: prepare_update_node
        targetHandle: target
        type: custom
        zIndex: 0
      - data:
          isInLoop: false
          sourceType: template-transform
          targetType: tool
        id: prepare_update-sheets_write-edge
        selected: false
        source: prepare_update_node
        sourceHandle: source
        target: sheets_write_node
        targetHandle: target
        type: custom
        zIndex: 0
      - data:
          isInLoop: false
          sourceType: tool
          targetType: answer
        id: sheets_write-answer-edge
        selected: false
        source: sheets_write_node
        sourceHandle: source
        target: answer_node
        targetHandle: target
        type: custom
        zIndex: 0
    nodes:
      - data:
          desc: "ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‹ã‚‰ã®ã‚¹ãƒ—ãƒ¬ãƒƒãƒ‰ã‚·ãƒ¼ãƒˆIDå…¥åŠ›ã‚’å—ã‘ä»˜ã‘ã¾ã™"
          selected: false
          title: "é–‹å§‹"
          type: start
          variables: []
        height: 54
        id: start_node
        position:
          x: 50
          y: 300
        positionAbsolute:
          x: 50
          y: 300
        selected: false
        sourcePosition: right
        targetPosition: left
        type: custom
        width: 244
      - data:
          type: tool
          provider_id: omluc/google_sheets/google_sheets
          provider_name: omluc/google_sheets/google_sheets
          provider_type: builtin
          tool_label: Batch Get
          tool_name: batch_get
          tool_description: Retrieve data from multiple ranges in a Google Sheet
          is_team_authorization: true
          output_schema: null
          tool_configurations:
            date_time_render_option: FORMATTED_STRING
            major_dimension: null
            value_render_option: null
          tool_parameters:
            ranges:
              type: mixed
              value: '["Sheet1!A:B"]'
            spreadsheet_id:
              type: mixed
              value: "{{#sys.query#}}"
          selected: false
          title: "å£²ä¸Šãƒ‡ãƒ¼ã‚¿èª­ã¿å–ã‚Š"
          desc: "Google Sheetsã®Aåˆ—ï¼ˆå–¶æ¥­å“¡åï¼‰ã¨Båˆ—ï¼ˆå£²ä¸Šé‡‘é¡ï¼‰ã‚’èª­ã¿å–ã‚Šã¾ã™"
        height: 90
        id: sheets_read_node
        position:
          x: 350
          y: 300
        positionAbsolute:
          x: 350
          y: 300
        selected: false
        sourcePosition: right
        targetPosition: left
        type: custom
        width: 244
      - data:
          type: template-transform
          variables:
            - value_selector:
                - sheets_read_node
                - json
              variable: sheet_data
              value_type: array[object]
          template: |
            å£²ä¸Šãƒ‡ãƒ¼ã‚¿ä¸€è¦§ï¼š
            {% if sheet_data and sheet_data[0] and sheet_data[0]["valueRanges"] and sheet_data[0]["valueRanges"][0] and sheet_data[0]["valueRanges"][0]["values"] %}
            {% set rows = sheet_data[0]["valueRanges"][0]["values"] %}
            {% for row in rows %}
            {% if loop.index > 1 and row|length >= 2 %}
            å–¶æ¥­å“¡å: {{ row[0] }}, å£²ä¸Šé‡‘é¡: {{ row[1] }}ä¸‡å††
            {% endif %}
            {% endfor %}
            {% else %}
            ãƒ‡ãƒ¼ã‚¿ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“ã§ã—ãŸã€‚
            {% endif %}
          selected: false
          title: "ãƒ‡ãƒ¼ã‚¿å¤‰æ›"
          desc: "èª­ã¿å–ã£ãŸãƒ‡ãƒ¼ã‚¿ã‚’LLMå‡¦ç†ç”¨ã«æ•´å½¢ã—ã¾ã™"
        height: 102
        id: transform_data_node
        position:
          x: 650
          y: 300
        positionAbsolute:
          x: 650
          y: 300
        selected: false
        sourcePosition: right
        targetPosition: left
        type: custom
        width: 244
      - data:
          type: llm
          provider: openai
          model:
            provider: openai
            name: gpt-4o-mini
            mode: chat
            completion_params:
              temperature: 0.1
              max_tokens: 2000
          prompt_template:
            - id: "system_prompt"
              role: system
              text: |
                ã‚ãªãŸã¯å£²ä¸Šè©•ä¾¡åˆ¤å®šã‚·ã‚¹ãƒ†ãƒ ã§ã™ã€‚
                ä»¥ä¸‹ã®åŸºæº–ã§å–¶æ¥­å“¡ã®å£²ä¸Šã‚’è©•ä¾¡ã—ã¦ãã ã•ã„ï¼š
                - 1000ä¸‡å††ä»¥ä¸Šï¼šé«˜è©•ä¾¡
                - 500ä¸‡å††ä»¥ä¸Š1000ä¸‡å††æœªæº€ï¼šä¸­è©•ä¾¡
                - 500ä¸‡å††æœªæº€ï¼šä½è©•ä¾¡
                
                å¿…ãšä»¥ä¸‹ã®JSONå½¢å¼ã§å‡ºåŠ›ã—ã¦ãã ã•ã„ï¼š
                ```json
                [
                  ["å–¶æ¥­å“¡å", "å£²ä¸Šé‡‘é¡", "è©•ä¾¡"],
                  ["å±±ç”°å¤ªéƒ", "1200", "é«˜è©•ä¾¡"],
                  ["ç”°ä¸­æ¬¡éƒ", "750", "ä¸­è©•ä¾¡"],
                  ["ä½è—¤ä¸‰éƒ", "300", "ä½è©•ä¾¡"]
                ]
                ```
                
                æ³¨æ„ï¼š
                1. æœ€åˆã®è¡Œã¯ãƒ˜ãƒƒãƒ€ãƒ¼è¡Œã§ã™
                2. å£²ä¸Šé‡‘é¡ã¯æ•°å€¤ã®ã¿ï¼ˆå˜ä½ãªã—ï¼‰ã§è¨˜è¼‰
                3. è©•ä¾¡ã¯ã€Œé«˜è©•ä¾¡ã€ã€Œä¸­è©•ä¾¡ã€ã€Œä½è©•ä¾¡ã€ã®ã„ãšã‚Œã‹
                4. å¿…ãšJSONé…åˆ—å½¢å¼ã§å‡ºåŠ›
            - id: "user_prompt"
              role: user
              text: |
                ä»¥ä¸‹ã®å£²ä¸Šãƒ‡ãƒ¼ã‚¿ã‚’è©•ä¾¡ã—ã¦ãã ã•ã„ï¼š
                
                {{#transform_data_node.output#}}
          structured_output_enabled: false
          variables: []
          context:
            enabled: false
            variable_selector: []
          vision:
            enabled: false
          selected: false
          title: "å£²ä¸Šè©•ä¾¡åˆ¤å®š"
          desc: "å„å–¶æ¥­å“¡ã®å£²ä¸Šé‡‘é¡ã‚’åŸºã«è©•ä¾¡ã‚’è¡Œã„ã¾ã™"
        height: 98
        id: llm_analyzer_node
        position:
          x: 950
          y: 300
        positionAbsolute:
          x: 950
          y: 300
        selected: false
        sourcePosition: right
        targetPosition: left
        type: custom
        width: 244
      - data:
          type: template-transform
          variables:
            - value_selector:
                - llm_analyzer_node
                - text
              variable: evaluation_result
              value_type: string
          template: |
            [{
              "range": "RESULT!A1:C100",
              "values": {{ evaluation_result|trim }}
            }]
          selected: false
          title: "æ›´æ–°ãƒ‡ãƒ¼ã‚¿æº–å‚™"
          desc: "è©•ä¾¡çµæœã‚’Google Sheetsæ›´æ–°ç”¨ã®å½¢å¼ã«å¤‰æ›ã—ã¾ã™"
        height: 102
        id: prepare_update_node
        position:
          x: 1250
          y: 300
        positionAbsolute:
          x: 1250
          y: 300
        selected: false
        sourcePosition: right
        targetPosition: left
        type: custom
        width: 244
      - data:
          type: tool
          provider_id: omluc/google_sheets/google_sheets
          provider_name: omluc/google_sheets/google_sheets
          provider_type: builtin
          tool_label: Batch Update
          tool_name: batch_update
          tool_description: Updates multiple ranges in a Google Sheet with specified values
          is_team_authorization: true
          output_schema: null
          tool_configurations:
            include_values_in_response: null
            response_date_time_render_option: null
            response_value_render_option: null
            value_input_option: USER_ENTERED
          tool_parameters:
            data:
              type: mixed
              value: "{{#prepare_update_node.output#}}"
            spreadsheet_id:
              type: mixed
              value: "{{#sys.query#}}"
          selected: false
          title: "çµæœæ›¸ãè¾¼ã¿"
          desc: "è©•ä¾¡çµæœã‚’RESULTã‚·ãƒ¼ãƒˆã«æ›¸ãè¾¼ã¿ã¾ã™"
        height: 90
        id: sheets_write_node
        position:
          x: 1550
          y: 300
        positionAbsolute:
          x: 1550
          y: 300
        selected: false
        sourcePosition: right
        targetPosition: left
        type: custom
        width: 244
      - data:
          answer: |
            å£²ä¸Šè©•ä¾¡åˆ¤å®šãŒå®Œäº†ã—ã¾ã—ãŸï¼
            
            å‡¦ç†çµæœï¼š
            {{#llm_analyzer_node.text#}}
            
            RESULTã‚·ãƒ¼ãƒˆã«è©•ä¾¡çµæœã‚’æ›¸ãè¾¼ã¿ã¾ã—ãŸã€‚
            Google Sheetsã§ã”ç¢ºèªãã ã•ã„ã€‚
          desc: "å‡¦ç†å®Œäº†ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’è¡¨ç¤ºã—ã¾ã™"
          selected: false
          title: "å®Œäº†"
          type: answer
          variables: []
        height: 107
        id: answer_node
        position:
          x: 1850
          y: 300
        positionAbsolute:
          x: 1850
          y: 300
        selected: false
        sourcePosition: right
        targetPosition: left
        type: custom
        width: 244
    viewport:
      x: 0
      y: 0
      zoom: 0.8