app:
  name: å•†å“åœ¨åº«ç®¡ç†ã‚·ã‚¹ãƒ†ãƒ 
  description: å•†å“ã®åœ¨åº«æ•°ã«å¿œã˜ã¦é©åˆ‡ãªç™ºæ³¨ææ¡ˆã‚’è¡Œã„ã¾ã™
  icon: ğŸ“¦
  icon_background: "#E1D7FF"
  mode: advanced-chat
  use_icon_as_answer_icon: false
dependencies: []
kind: app
version: 0.3.0
workflow:
  conversation_variables: []
  environment_variables: []
  features:
    file_upload:
      enabled: false
    opening_statement: "å•†å“åœ¨åº«ç®¡ç†ã‚·ã‚¹ãƒ†ãƒ ã¸ã‚ˆã†ã“ãï¼\n\nå•†å“åã¨ç¾åœ¨ã®åœ¨åº«æ•°ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„ã€‚åœ¨åº«çŠ¶æ³ã«å¿œã˜ã¦é©åˆ‡ãªç™ºæ³¨ææ¡ˆã‚’ã„ãŸã—ã¾ã™ã€‚"
    retriever_resource:
      enabled: false
    sensitive_word_avoidance:
      enabled: false
    speech_to_text:
      enabled: false
    suggested_questions: []
    suggested_questions_after_answer:
      enabled: false
    text_to_speech:
      enabled: false
      language: ""
      voice: ""
  graph:
    nodes:
      - data:
          desc: ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼ã®é–‹å§‹åœ°ç‚¹
          selected: false
          title: é–‹å§‹
          type: start
          variables: []
        height: 53
        id: start_node
        position:
          x: 50
          y: 300
        positionAbsolute:
          x: 50
          y: 300
        selected: false
        sourcePosition: right
        targetPosition: left
        type: custom
        width: 244
      - data:
          desc: ãƒ¦ãƒ¼ã‚¶ãƒ¼å…¥åŠ›ã‹ã‚‰å•†å“åã¨åœ¨åº«æ•°ã‚’æŠ½å‡º
          jinja2_variables: []
          llm:
            context:
              enabled: false
              variable_selector: []
            max_tokens: 512
            model:
              completion_params:
                temperature: 0.3
              mode: chat
              name: claude-3-5-sonnet-20241022
              provider: anthropic
            prompt_template:
              - id: 5f47f3d3-af67-4846-9fa6-a3bb9b77523e
                role: system
                text: |
                  ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®å…¥åŠ›ã‹ã‚‰å•†å“åã¨åœ¨åº«æ•°ã‚’æŠ½å‡ºã—ã¦ãã ã•ã„ã€‚
                  å¿…ãšä»¥ä¸‹ã®å½¢å¼ã§å‡ºåŠ›ã—ã¦ãã ã•ã„ï¼š
                  å•†å“åï¼š[å•†å“å]
                  åœ¨åº«æ•°ï¼š[æ•°å€¤ã®ã¿]
              - id: 0f973c24-41ac-48b9-bc7e-05962ab09010
                role: user
                text: "{{#sys.query#}}"
            tools: []
            vision:
              enabled: false
          memory:
            role_prefix:
              assistant: ""
              user: ""
            window:
              enabled: false
              size: 50
          selected: false
          title: å…¥åŠ›è§£æ
          type: llm
        height: 97
        id: input_analysis_node
        position:
          x: 350
          y: 300
        positionAbsolute:
          x: 350
          y: 300
        selected: false
        sourcePosition: right
        targetPosition: left
        type: custom
        width: 244
      - data:
          code: |
            import re
            
            text = input_analysis
            
            product_match = re.search(r'å•†å“åï¼š(.+)', text)
            stock_match = re.search(r'åœ¨åº«æ•°ï¼š(\d+)', text)
            
            product_name = product_match.group(1).strip() if product_match else "ä¸æ˜"
            stock_quantity = int(stock_match.group(1)) if stock_match else 0
            
            return {
                "product_name": product_name,
                "stock_quantity": stock_quantity
            }
          desc: å…¥åŠ›ã‹ã‚‰å•†å“åã¨åœ¨åº«æ•°ã‚’æŠ½å‡º
          selected: false
          title: ãƒ‡ãƒ¼ã‚¿æŠ½å‡º
          type: code
          variables:
            - value_selector:
                - input_analysis_node
                - text
              variable: input_analysis
        height: 131
        id: variable_assignment_node
        position:
          x: 650
          y: 300
        positionAbsolute:
          x: 650
          y: 300
        selected: false
        sourcePosition: right
        targetPosition: left
        type: custom
        width: 244
      - data:
          cases:
            - case_id: urgent_order
              conditions:
                - comparison_operator: "<="
                  id: stock_check_urgent
                  variable_selector:
                    - variable_assignment_node
                    - stock_quantity
                  value: 10
              id: urgent_order
              logical_operator: and
            - case_id: normal_order
              conditions:
                - comparison_operator: "<="
                  id: stock_check_normal
                  variable_selector:
                    - variable_assignment_node
                    - stock_quantity
                  value: 50
              id: normal_order
              logical_operator: and
          desc: åœ¨åº«æ•°ã«å¿œã˜ã¦å‡¦ç†ã‚’åˆ†å²
          selected: false
          title: åœ¨åº«åˆ¤å®š
          type: if-else
        height: 176
        id: stock_check_node
        position:
          x: 950
          y: 300
        positionAbsolute:
          x: 950
          y: 300
        selected: false
        sourcePosition: right
        targetPosition: left
        type: custom
        width: 244
      - data:
          desc: ç·Šæ€¥ç™ºæ³¨ãŒå¿…è¦ãªå ´åˆã®å¯¾å¿œæ¡ˆã‚’ç”Ÿæˆ
          jinja2_variables: []
          llm:
            context:
              enabled: false
              variable_selector: []
            max_tokens: 1024
            model:
              completion_params:
                temperature: 0.7
              mode: chat
              name: claude-3-5-sonnet-20241022
              provider: anthropic
            prompt_template:
              - id: e8f47f3d-af67-4846-9fa6-a3bb9b77523f
                role: system
                text: ã‚ãªãŸã¯åœ¨åº«ç®¡ç†ã®å°‚é–€å®¶ã§ã™ã€‚ç·Šæ€¥ç™ºæ³¨ãŒå¿…è¦ãªçŠ¶æ³ã«ã¤ã„ã¦ã€å…·ä½“çš„ãªå¯¾å¿œæ¡ˆã‚’ææ¡ˆã—ã¦ãã ã•ã„ã€‚
              - id: f0f973c24-41ac-48b9-bc7e-05962ab09011
                role: user
                text: "å•†å“ã€Œ{{#variable_assignment_node.product_name#}}ã€ã®åœ¨åº«ãŒ{{#variable_assignment_node.stock_quantity#}}å€‹ã—ã‹ã‚ã‚Šã¾ã›ã‚“ã€‚ç·Šæ€¥ç™ºæ³¨ãŒå¿…è¦ã§ã™ã€‚æ¨å¥¨ç™ºæ³¨æ•°ã¨ç†ç”±ã‚’èª¬æ˜ã—ã¦ãã ã•ã„ã€‚"
            tools: []
            vision:
              enabled: false
          memory:
            role_prefix:
              assistant: ""
              user: ""
            window:
              enabled: false
              size: 50
          selected: false
          title: ç·Šæ€¥ç™ºæ³¨ææ¡ˆ
          type: llm
        height: 97
        id: urgent_order_llm_node
        position:
          x: 1250
          y: 100
        positionAbsolute:
          x: 1250
          y: 100
        selected: false
        sourcePosition: right
        targetPosition: left
        type: custom
        width: 244
      - data:
          desc: é€šå¸¸ç™ºæ³¨ã‚’æ¤œè¨ã™ã¹ãå ´åˆã®å¯¾å¿œæ¡ˆã‚’ç”Ÿæˆ
          jinja2_variables: []
          llm:
            context:
              enabled: false
              variable_selector: []
            max_tokens: 1024
            model:
              completion_params:
                temperature: 0.7
              mode: chat
              name: claude-3-5-sonnet-20241022
              provider: anthropic
            prompt_template:
              - id: a8f47f3d-af67-4846-9fa6-a3bb9b77523g
                role: system
                text: ã‚ãªãŸã¯åœ¨åº«ç®¡ç†ã®å°‚é–€å®¶ã§ã™ã€‚é€šå¸¸ç™ºæ³¨ã®ã‚¿ã‚¤ãƒŸãƒ³ã‚°ã¨æ•°é‡ã«ã¤ã„ã¦ã€é©åˆ‡ãªã‚¢ãƒ‰ãƒã‚¤ã‚¹ã‚’æä¾›ã—ã¦ãã ã•ã„ã€‚
              - id: b0f973c24-41ac-48b9-bc7e-05962ab09012
                role: user
                text: "å•†å“ã€Œ{{#variable_assignment_node.product_name#}}ã€ã®åœ¨åº«ãŒ{{#variable_assignment_node.stock_quantity#}}å€‹ã§ã™ã€‚é€šå¸¸ç™ºæ³¨ã‚’æ¤œè¨ã™ã¹ãçŠ¶æ³ã§ã™ã€‚é©åˆ‡ãªç™ºæ³¨ã‚¿ã‚¤ãƒŸãƒ³ã‚°ã¨æ¨å¥¨æ•°é‡ã‚’ææ¡ˆã—ã¦ãã ã•ã„ã€‚"
            tools: []
            vision:
              enabled: false
          memory:
            role_prefix:
              assistant: ""
              user: ""
            window:
              enabled: false
              size: 50
          selected: false
          title: é€šå¸¸ç™ºæ³¨ææ¡ˆ
          type: llm
        height: 97
        id: normal_order_llm_node
        position:
          x: 1250
          y: 300
        positionAbsolute:
          x: 1250
          y: 300
        selected: false
        sourcePosition: right
        targetPosition: left
        type: custom
        width: 244
      - data:
          desc: åœ¨åº«ãŒååˆ†ãªå ´åˆã®ã‚¢ãƒ‰ãƒã‚¤ã‚¹ã‚’ç”Ÿæˆ
          jinja2_variables: []
          llm:
            context:
              enabled: false
              variable_selector: []
            max_tokens: 1024
            model:
              completion_params:
                temperature: 0.7
              mode: chat
              name: claude-3-5-sonnet-20241022
              provider: anthropic
            prompt_template:
              - id: c8f47f3d-af67-4846-9fa6-a3bb9b77523h
                role: system
                text: ã‚ãªãŸã¯åœ¨åº«ç®¡ç†ã®å°‚é–€å®¶ã§ã™ã€‚åœ¨åº«ãŒååˆ†ã«ã‚ã‚‹å ´åˆã®ç®¡ç†ã‚¢ãƒ‰ãƒã‚¤ã‚¹ã‚’æä¾›ã—ã¦ãã ã•ã„ã€‚
              - id: d0f973c24-41ac-48b9-bc7e-05962ab09013
                role: user
                text: "å•†å“ã€Œ{{#variable_assignment_node.product_name#}}ã€ã®åœ¨åº«ãŒ{{#variable_assignment_node.stock_quantity#}}å€‹ã‚ã‚Šã¾ã™ã€‚åœ¨åº«ã¯ååˆ†ã§ã™ã€‚åŠ¹ç‡çš„ãªåœ¨åº«ç®¡ç†ã®ãŸã‚ã®ã‚¢ãƒ‰ãƒã‚¤ã‚¹ã‚’ãŠé¡˜ã„ã—ã¾ã™ã€‚"
            tools: []
            vision:
              enabled: false
          memory:
            role_prefix:
              assistant: ""
              user: ""
            window:
              enabled: false
              size: 50
          selected: false
          title: åœ¨åº«ç®¡ç†ã‚¢ãƒ‰ãƒã‚¤ã‚¹
          type: llm
        height: 97
        id: sufficient_stock_llm_node
        position:
          x: 1250
          y: 500
        positionAbsolute:
          x: 1250
          y: 500
        selected: false
        sourcePosition: right
        targetPosition: left
        type: custom
        width: 244
      - data:
          answer: "{{#urgent_order_llm_node.text#}}"
          desc: ç·Šæ€¥ç™ºæ³¨ã®ææ¡ˆã‚’è¡¨ç¤º
          selected: false
          title: ç·Šæ€¥ç™ºæ³¨çµæœ
          type: answer
        height: 64
        id: urgent_answer_node
        position:
          x: 1550
          y: 100
        positionAbsolute:
          x: 1550
          y: 100
        selected: false
        sourcePosition: right
        targetPosition: left
        type: custom
        width: 244
      - data:
          answer: "{{#normal_order_llm_node.text#}}"
          desc: é€šå¸¸ç™ºæ³¨ã®ææ¡ˆã‚’è¡¨ç¤º
          selected: false
          title: é€šå¸¸ç™ºæ³¨çµæœ
          type: answer
        height: 64
        id: normal_answer_node
        position:
          x: 1550
          y: 300
        positionAbsolute:
          x: 1550
          y: 300
        selected: false
        sourcePosition: right
        targetPosition: left
        type: custom
        width: 244
      - data:
          answer: "{{#sufficient_stock_llm_node.text#}}"
          desc: åœ¨åº«ç®¡ç†ã‚¢ãƒ‰ãƒã‚¤ã‚¹ã‚’è¡¨ç¤º
          selected: false
          title: åœ¨åº«ååˆ†çµæœ
          type: answer
        height: 64
        id: sufficient_answer_node
        position:
          x: 1550
          y: 500
        positionAbsolute:
          x: 1550
          y: 500
        selected: false
        sourcePosition: right
        targetPosition: left
        type: custom
        width: 244
    edges:
      - data:
          isInLoop: false
          sourceType: start
          targetType: llm
        id: edge_1
        selected: false
        source: start_node
        sourceHandle: source
        target: input_analysis_node
        targetHandle: target
        type: custom
        zIndex: 0
      - data:
          isInLoop: false
          sourceType: llm
          targetType: code
        id: edge_2
        selected: false
        source: input_analysis_node
        sourceHandle: source
        target: variable_assignment_node
        targetHandle: target
        type: custom
        zIndex: 0
      - data:
          isInLoop: false
          sourceType: code
          targetType: if-else
        id: edge_3
        selected: false
        source: variable_assignment_node
        sourceHandle: source
        target: stock_check_node
        targetHandle: target
        type: custom
        zIndex: 0
      - data:
          isInLoop: false
          sourceType: if-else
          targetType: llm
        id: edge_urgent
        selected: false
        source: stock_check_node
        sourceHandle: urgent_order
        target: urgent_order_llm_node
        targetHandle: target
        type: custom
        zIndex: 0
      - data:
          isInLoop: false
          sourceType: if-else
          targetType: llm
        id: edge_normal
        selected: false
        source: stock_check_node
        sourceHandle: normal_order
        target: normal_order_llm_node
        targetHandle: target
        type: custom
        zIndex: 0
      - data:
          isInLoop: false
          sourceType: if-else
          targetType: llm
        id: edge_sufficient
        selected: false
        source: stock_check_node
        sourceHandle: "false"
        target: sufficient_stock_llm_node
        targetHandle: target
        type: custom
        zIndex: 0
      - data:
          isInLoop: false
          sourceType: llm
          targetType: answer
        id: edge_urgent_answer
        selected: false
        source: urgent_order_llm_node
        sourceHandle: source
        target: urgent_answer_node
        targetHandle: target
        type: custom
        zIndex: 0
      - data:
          isInLoop: false
          sourceType: llm
          targetType: answer
        id: edge_normal_answer
        selected: false
        source: normal_order_llm_node
        sourceHandle: source
        target: normal_answer_node
        targetHandle: target
        type: custom
        zIndex: 0
      - data:
          isInLoop: false
          sourceType: llm
          targetType: answer
        id: edge_sufficient_answer
        selected: false
        source: sufficient_stock_llm_node
        sourceHandle: source
        target: sufficient_answer_node
        targetHandle: target
        type: custom
        zIndex: 0
    viewport:
      x: 0
      y: 0
      zoom: 0.8