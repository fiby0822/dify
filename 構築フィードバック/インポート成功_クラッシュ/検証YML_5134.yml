app:
  description: "IF_ELSEã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã®ãƒ«ãƒ¼ãƒ«æ¤œè¨¼ç”¨ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã€‚ã‚¹ã‚³ã‚¢ã¨è©•ä¾¡ã‚¿ã‚¤ãƒ—ã«åŸºã¥ã„ã¦ç·åˆåˆ¤å®šã‚’è¡Œã„ã¾ã™ã€‚"
  icon: "ðŸ“Š"
  icon_background: "#E8F4FD"
  mode: advanced-chat
  name: "ç·åˆã‚¹ã‚³ã‚¢åˆ¤å®šã‚·ã‚¹ãƒ†ãƒ "
  use_icon_as_answer_icon: false

dependencies: []

kind: app

version: 0.3.0

workflow:
  conversation_variables: []
  environment_variables: []
  features:
    file_upload:
      enabled: false
    opening_statement: |
      ç·åˆã‚¹ã‚³ã‚¢åˆ¤å®šã‚·ã‚¹ãƒ†ãƒ ã¸ã‚ˆã†ã“ãï¼
      
      ä»¥ä¸‹ã®æƒ…å ±ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„ï¼š
      1. ã‚¹ã‚³ã‚¢ï¼ˆ0-100ã®æ•°å€¤ï¼‰
      2. è©•ä¾¡ã‚¿ã‚¤ãƒ—ï¼ˆåŽ³æ ¼/æ¨™æº–/å¯›å®¹ï¼‰
      
      ä¾‹ï¼šã€Œã‚¹ã‚³ã‚¢: 85, è©•ä¾¡ã‚¿ã‚¤ãƒ—: æ¨™æº–ã€
    retriever_resource:
      enabled: false
    sensitive_word_avoidance:
      enabled: false
    speech_to_text:
      enabled: false
    suggested_questions:
      - "ã‚¹ã‚³ã‚¢: 95, è©•ä¾¡ã‚¿ã‚¤ãƒ—: åŽ³æ ¼"
      - "ã‚¹ã‚³ã‚¢: 75, è©•ä¾¡ã‚¿ã‚¤ãƒ—: æ¨™æº–"
      - "ã‚¹ã‚³ã‚¢: 45, è©•ä¾¡ã‚¿ã‚¤ãƒ—: å¯›å®¹"
    suggested_questions_after_answer:
      enabled: false
    text_to_speech:
      enabled: false
  graph:
    edges:
      - data:
          isInLoop: false
          sourceType: start
          targetType: code
        id: start-extract-edge
        selected: false
        source: start_node
        sourceHandle: source
        target: extract_input_node
        targetHandle: target
        type: custom
        zIndex: 0
      - data:
          isInLoop: false
          sourceType: code
          targetType: if-else
        id: extract-condition-edge
        selected: false
        source: extract_input_node
        sourceHandle: source
        target: score_condition_node
        targetHandle: target
        type: custom
        zIndex: 0
      - data:
          isInLoop: false
          sourceType: if-else
          targetType: llm
        id: condition-excellent-edge
        selected: false
        source: score_condition_node
        sourceHandle: excellent_case
        target: excellent_result_node
        targetHandle: target
        type: custom
        zIndex: 0
      - data:
          isInLoop: false
          sourceType: if-else
          targetType: llm
        id: condition-good-edge
        selected: false
        source: score_condition_node
        sourceHandle: good_case
        target: good_result_node
        targetHandle: target
        type: custom
        zIndex: 0
      - data:
          isInLoop: false
          sourceType: if-else
          targetType: llm
        id: condition-average-edge
        selected: false
        source: score_condition_node
        sourceHandle: average_case
        target: average_result_node
        targetHandle: target
        type: custom
        zIndex: 0
      - data:
          isInLoop: false
          sourceType: if-else
          targetType: llm
        id: condition-poor-edge
        selected: false
        source: score_condition_node
        sourceHandle: false
        target: poor_result_node
        targetHandle: target
        type: custom
        zIndex: 0
      - data:
          isInLoop: false
          sourceType: llm
          targetType: answer
        id: excellent-answer-edge
        selected: false
        source: excellent_result_node
        sourceHandle: source
        target: excellent_answer_node
        targetHandle: target
        type: custom
        zIndex: 0
      - data:
          isInLoop: false
          sourceType: llm
          targetType: answer
        id: good-answer-edge
        selected: false
        source: good_result_node
        sourceHandle: source
        target: good_answer_node
        targetHandle: target
        type: custom
        zIndex: 0
      - data:
          isInLoop: false
          sourceType: llm
          targetType: answer
        id: average-answer-edge
        selected: false
        source: average_result_node
        sourceHandle: source
        target: average_answer_node
        targetHandle: target
        type: custom
        zIndex: 0
      - data:
          isInLoop: false
          sourceType: llm
          targetType: answer
        id: poor-answer-edge
        selected: false
        source: poor_result_node
        sourceHandle: source
        target: poor_answer_node
        targetHandle: target
        type: custom
        zIndex: 0
    nodes:
      - data:
          desc: "é–‹å§‹ãƒŽãƒ¼ãƒ‰"
          selected: false
          title: "é–‹å§‹"
          type: start
          variables: []
        height: 54
        id: start_node
        position:
          x: 50
          y: 300
        positionAbsolute:
          x: 50
          y: 300
        selected: false
        sourcePosition: right
        targetPosition: left
        type: custom
        width: 244
      - data:
          type: code
          code: |
            def main(user_input):
                import re
                
                score_match = re.search(r'ã‚¹ã‚³ã‚¢[ï¼š:\s]*(\d+)', user_input)
                type_match = re.search(r'è©•ä¾¡ã‚¿ã‚¤ãƒ—[ï¼š:\s]*(\S+)', user_input)
                
                score = 0
                eval_type = "æ¨™æº–"
                
                if score_match:
                    score = int(score_match.group(1))
                    if score > 100:
                        score = 100
                    elif score < 0:
                        score = 0
                
                if type_match:
                    eval_type = type_match.group(1)
                    if eval_type not in ["åŽ³æ ¼", "æ¨™æº–", "å¯›å®¹"]:
                        eval_type = "æ¨™æº–"
                
                return {
                    "score": score,
                    "eval_type": eval_type
                }
          code_language: python3
          outputs:
            score:
              type: number
              children: null
            eval_type:
              type: string
              children: null
          inputs:
            user_input:
              value_selector:
                - sys
                - query
              type: string
          desc: "ãƒ¦ãƒ¼ã‚¶ãƒ¼å…¥åŠ›ã‹ã‚‰ã‚¹ã‚³ã‚¢ã¨è©•ä¾¡ã‚¿ã‚¤ãƒ—ã‚’æŠ½å‡º"
          selected: false
          title: "å…¥åŠ›è§£æž"
        height: 54
        id: extract_input_node
        position:
          x: 350
          y: 300
        positionAbsolute:
          x: 350
          y: 300
        selected: false
        sourcePosition: right
        targetPosition: left
        type: custom
        width: 244
      - data:
          type: if-else
          cases:
            - id: excellent_case
              case_id: excellent_case
              conditions:
                - variable_selector:
                    - extract_input_node
                    - score
                  comparison_operator: "â‰¥"
                  value: 90
              logical_operator: and
            - id: good_case
              case_id: good_case
              conditions:
                - variable_selector:
                    - extract_input_node
                    - score
                  comparison_operator: "â‰¥"
                  value: 70
              logical_operator: and
            - id: average_case
              case_id: average_case
              conditions:
                - variable_selector:
                    - extract_input_node
                    - score
                  comparison_operator: "â‰¥"
                  value: 50
              logical_operator: and
          desc: "ã‚¹ã‚³ã‚¢ãƒ¬ãƒ™ãƒ«ã®åˆ¤å®š"
          selected: false
          title: "ã‚¹ã‚³ã‚¢æ¡ä»¶åˆ†å²"
        height: 198
        id: score_condition_node
        position:
          x: 650
          y: 300
        positionAbsolute:
          x: 650
          y: 300
        selected: false
        sourcePosition: right
        targetPosition: left
        type: custom
        width: 244
      - data:
          model:
            provider: openai
            name: gpt-4o-mini
            mode: chat
          prompt_template:
            - id: system-prompt-excellent
              role: system
              text: |
                ã‚ãªãŸã¯ã‚¹ã‚³ã‚¢åˆ¤å®šã‚·ã‚¹ãƒ†ãƒ ã§ã™ã€‚
                å„ªç§€ãƒ¬ãƒ™ãƒ«ï¼ˆ90ç‚¹ä»¥ä¸Šï¼‰ã®çµæžœã‚’è©•ä¾¡ã‚¿ã‚¤ãƒ—ã«å¿œã˜ã¦åˆ¤å®šã—ã¾ã™ã€‚
            - id: user-prompt-excellent
              role: user
              text: |
                ã‚¹ã‚³ã‚¢: {{#extract_input_node.score#}}
                è©•ä¾¡ã‚¿ã‚¤ãƒ—: {{#extract_input_node.eval_type#}}
                
                ã“ã®ã‚¹ã‚³ã‚¢ã¯å„ªç§€ãƒ¬ãƒ™ãƒ«ã§ã™ã€‚è©•ä¾¡ã‚¿ã‚¤ãƒ—ã«å¿œã˜ãŸåˆ¤å®šçµæžœã¨ã‚³ãƒ¡ãƒ³ãƒˆã‚’æä¾›ã—ã¦ãã ã•ã„ã€‚
                
                å½¢å¼ï¼š
                ã€åˆ¤å®šçµæžœã€‘å„ªç§€
                ã€ã‚¹ã‚³ã‚¢ã€‘XXç‚¹
                ã€è©•ä¾¡ã‚¿ã‚¤ãƒ—ã€‘XX
                ã€ã‚³ãƒ¡ãƒ³ãƒˆã€‘è©•ä¾¡ã‚¿ã‚¤ãƒ—ã«å¿œã˜ãŸè©³ç´°ãªãƒ•ã‚£ãƒ¼ãƒ‰ãƒãƒƒã‚¯
          completion_params:
            temperature: 0.3
          structured_output_enabled: false
          vision:
            enabled: false
          context:
            enabled: false
            variable_selector: []
          desc: "å„ªç§€ãƒ¬ãƒ™ãƒ«ã®åˆ¤å®šå‡¦ç†"
          selected: false
          title: "å„ªç§€åˆ¤å®š"
        height: 98
        id: excellent_result_node
        position:
          x: 950
          y: 100
        positionAbsolute:
          x: 950
          y: 100
        selected: false
        sourcePosition: right
        targetPosition: left
        type: custom
        width: 244
      - data:
          model:
            provider: openai
            name: gpt-4o-mini
            mode: chat
          prompt_template:
            - id: system-prompt-good
              role: system
              text: |
                ã‚ãªãŸã¯ã‚¹ã‚³ã‚¢åˆ¤å®šã‚·ã‚¹ãƒ†ãƒ ã§ã™ã€‚
                è‰¯å¥½ãƒ¬ãƒ™ãƒ«ï¼ˆ70-89ç‚¹ï¼‰ã®çµæžœã‚’è©•ä¾¡ã‚¿ã‚¤ãƒ—ã«å¿œã˜ã¦åˆ¤å®šã—ã¾ã™ã€‚
            - id: user-prompt-good
              role: user
              text: |
                ã‚¹ã‚³ã‚¢: {{#extract_input_node.score#}}
                è©•ä¾¡ã‚¿ã‚¤ãƒ—: {{#extract_input_node.eval_type#}}
                
                ã“ã®ã‚¹ã‚³ã‚¢ã¯è‰¯å¥½ãƒ¬ãƒ™ãƒ«ã§ã™ã€‚è©•ä¾¡ã‚¿ã‚¤ãƒ—ã«å¿œã˜ãŸåˆ¤å®šçµæžœã¨ã‚³ãƒ¡ãƒ³ãƒˆã‚’æä¾›ã—ã¦ãã ã•ã„ã€‚
                
                å½¢å¼ï¼š
                ã€åˆ¤å®šçµæžœã€‘è‰¯å¥½
                ã€ã‚¹ã‚³ã‚¢ã€‘XXç‚¹
                ã€è©•ä¾¡ã‚¿ã‚¤ãƒ—ã€‘XX
                ã€ã‚³ãƒ¡ãƒ³ãƒˆã€‘è©•ä¾¡ã‚¿ã‚¤ãƒ—ã«å¿œã˜ãŸè©³ç´°ãªãƒ•ã‚£ãƒ¼ãƒ‰ãƒãƒƒã‚¯
          completion_params:
            temperature: 0.3
          structured_output_enabled: false
          vision:
            enabled: false
          context:
            enabled: false
            variable_selector: []
          desc: "è‰¯å¥½ãƒ¬ãƒ™ãƒ«ã®åˆ¤å®šå‡¦ç†"
          selected: false
          title: "è‰¯å¥½åˆ¤å®š"
        height: 98
        id: good_result_node
        position:
          x: 950
          y: 250
        positionAbsolute:
          x: 950
          y: 250
        selected: false
        sourcePosition: right
        targetPosition: left
        type: custom
        width: 244
      - data:
          model:
            provider: openai
            name: gpt-4o-mini
            mode: chat
          prompt_template:
            - id: system-prompt-average
              role: system
              text: |
                ã‚ãªãŸã¯ã‚¹ã‚³ã‚¢åˆ¤å®šã‚·ã‚¹ãƒ†ãƒ ã§ã™ã€‚
                æ™®é€šãƒ¬ãƒ™ãƒ«ï¼ˆ50-69ç‚¹ï¼‰ã®çµæžœã‚’è©•ä¾¡ã‚¿ã‚¤ãƒ—ã«å¿œã˜ã¦åˆ¤å®šã—ã¾ã™ã€‚
            - id: user-prompt-average
              role: user
              text: |
                ã‚¹ã‚³ã‚¢: {{#extract_input_node.score#}}
                è©•ä¾¡ã‚¿ã‚¤ãƒ—: {{#extract_input_node.eval_type#}}
                
                ã“ã®ã‚¹ã‚³ã‚¢ã¯æ™®é€šãƒ¬ãƒ™ãƒ«ã§ã™ã€‚è©•ä¾¡ã‚¿ã‚¤ãƒ—ã«å¿œã˜ãŸåˆ¤å®šçµæžœã¨ã‚³ãƒ¡ãƒ³ãƒˆã‚’æä¾›ã—ã¦ãã ã•ã„ã€‚
                
                å½¢å¼ï¼š
                ã€åˆ¤å®šçµæžœã€‘æ™®é€š
                ã€ã‚¹ã‚³ã‚¢ã€‘XXç‚¹
                ã€è©•ä¾¡ã‚¿ã‚¤ãƒ—ã€‘XX
                ã€ã‚³ãƒ¡ãƒ³ãƒˆã€‘è©•ä¾¡ã‚¿ã‚¤ãƒ—ã«å¿œã˜ãŸè©³ç´°ãªãƒ•ã‚£ãƒ¼ãƒ‰ãƒãƒƒã‚¯
          completion_params:
            temperature: 0.3
          structured_output_enabled: false
          vision:
            enabled: false
          context:
            enabled: false
            variable_selector: []
          desc: "æ™®é€šãƒ¬ãƒ™ãƒ«ã®åˆ¤å®šå‡¦ç†"
          selected: false
          title: "æ™®é€šåˆ¤å®š"
        height: 98
        id: average_result_node
        position:
          x: 950
          y: 400
        positionAbsolute:
          x: 950
          y: 400
        selected: false
        sourcePosition: right
        targetPosition: left
        type: custom
        width: 244
      - data:
          model:
            provider: openai
            name: gpt-4o-mini
            mode: chat
          prompt_template:
            - id: system-prompt-poor
              role: system
              text: |
                ã‚ãªãŸã¯ã‚¹ã‚³ã‚¢åˆ¤å®šã‚·ã‚¹ãƒ†ãƒ ã§ã™ã€‚
                è¦åŠªåŠ›ãƒ¬ãƒ™ãƒ«ï¼ˆ50ç‚¹æœªæº€ï¼‰ã®çµæžœã‚’è©•ä¾¡ã‚¿ã‚¤ãƒ—ã«å¿œã˜ã¦åˆ¤å®šã—ã¾ã™ã€‚
            - id: user-prompt-poor
              role: user
              text: |
                ã‚¹ã‚³ã‚¢: {{#extract_input_node.score#}}
                è©•ä¾¡ã‚¿ã‚¤ãƒ—: {{#extract_input_node.eval_type#}}
                
                ã“ã®ã‚¹ã‚³ã‚¢ã¯è¦åŠªåŠ›ãƒ¬ãƒ™ãƒ«ã§ã™ã€‚è©•ä¾¡ã‚¿ã‚¤ãƒ—ã«å¿œã˜ãŸåˆ¤å®šçµæžœã¨ã‚³ãƒ¡ãƒ³ãƒˆã‚’æä¾›ã—ã¦ãã ã•ã„ã€‚
                
                å½¢å¼ï¼š
                ã€åˆ¤å®šçµæžœã€‘è¦åŠªåŠ›
                ã€ã‚¹ã‚³ã‚¢ã€‘XXç‚¹
                ã€è©•ä¾¡ã‚¿ã‚¤ãƒ—ã€‘XX
                ã€ã‚³ãƒ¡ãƒ³ãƒˆã€‘è©•ä¾¡ã‚¿ã‚¤ãƒ—ã«å¿œã˜ãŸè©³ç´°ãªãƒ•ã‚£ãƒ¼ãƒ‰ãƒãƒƒã‚¯
          completion_params:
            temperature: 0.3
          structured_output_enabled: false
          vision:
            enabled: false
          context:
            enabled: false
            variable_selector: []
          desc: "è¦åŠªåŠ›ãƒ¬ãƒ™ãƒ«ã®åˆ¤å®šå‡¦ç†"
          selected: false
          title: "è¦åŠªåŠ›åˆ¤å®š"
        height: 98
        id: poor_result_node
        position:
          x: 950
          y: 550
        positionAbsolute:
          x: 950
          y: 550
        selected: false
        sourcePosition: right
        targetPosition: left
        type: custom
        width: 244
      - data:
          answer: "{{#excellent_result_node.text#}}"
          desc: "å„ªç§€åˆ¤å®šã®çµæžœå‡ºåŠ›"
          selected: false
          title: "å„ªç§€çµæžœ"
          type: answer
          variables: []
        height: 107
        id: excellent_answer_node
        position:
          x: 1250
          y: 100
        positionAbsolute:
          x: 1250
          y: 100
        selected: false
        sourcePosition: right
        targetPosition: left
        type: custom
        width: 244
      - data:
          answer: "{{#good_result_node.text#}}"
          desc: "è‰¯å¥½åˆ¤å®šã®çµæžœå‡ºåŠ›"
          selected: false
          title: "è‰¯å¥½çµæžœ"
          type: answer
          variables: []
        height: 107
        id: good_answer_node
        position:
          x: 1250
          y: 250
        positionAbsolute:
          x: 1250
          y: 250
        selected: false
        sourcePosition: right
        targetPosition: left
        type: custom
        width: 244
      - data:
          answer: "{{#average_result_node.text#}}"
          desc: "æ™®é€šåˆ¤å®šã®çµæžœå‡ºåŠ›"
          selected: false
          title: "æ™®é€šçµæžœ"
          type: answer
          variables: []
        height: 107
        id: average_answer_node
        position:
          x: 1250
          y: 400
        positionAbsolute:
          x: 1250
          y: 400
        selected: false
        sourcePosition: right
        targetPosition: left
        type: custom
        width: 244
      - data:
          answer: "{{#poor_result_node.text#}}"
          desc: "è¦åŠªåŠ›åˆ¤å®šã®çµæžœå‡ºåŠ›"
          selected: false
          title: "è¦åŠªåŠ›çµæžœ"
          type: answer
          variables: []
        height: 107
        id: poor_answer_node
        position:
          x: 1250
          y: 550
        positionAbsolute:
          x: 1250
          y: 550
        selected: false
        sourcePosition: right
        targetPosition: left
        type: custom
        width: 244
    viewport:
      x: 0
      y: 0
      zoom: 0.8