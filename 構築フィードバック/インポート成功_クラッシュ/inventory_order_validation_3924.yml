app:
  description: å•†å“åœ¨åº«ç®¡ç†ã¨æ³¨æ–‡å‡¦ç†åˆ¤å®šã‚·ã‚¹ãƒ†ãƒ 
  icon: ğŸ“¦
  icon_background: '#E0F2FE'
  mode: advanced-chat
  name: åœ¨åº«ç®¡ç†æ³¨æ–‡å‡¦ç†ã‚·ã‚¹ãƒ†ãƒ 
  use_icon_as_answer_icon: false
kind: app
version: 0.3.0
dependencies: []
workflow:
  environment_variables: []
  conversation_variables: []
  features:
    file_upload:
      image:
        enabled: false
        number_limits: 3
        transfer_methods:
          - local_file
          - remote_url
    opening_statement: å•†å“ã®æ³¨æ–‡ã‚’å‡¦ç†ã—ã¾ã™ã€‚å•†å“åã€æ³¨æ–‡æ•°é‡ã€å˜ä¾¡ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„ã€‚
    retriever_resource:
      enabled: false
    sensitive_word_avoidance:
      enabled: false
    speech_to_text:
      enabled: false
    suggested_questions: []
    suggested_questions_after_answer:
      enabled: false
    text_to_speech:
      enabled: false
      language: ja-JP
      voice: ja-JP-NanamiNeural
  graph:
    edges:
      - data:
          priority: 0
          selected: false
          smooth: false
          sourceType: start
          targetType: code
          title: null
          type: custom
          zIndex: 0
        id: start-data_parser
        selected: false
        source: start
        sourceHandle: source
        target: data_parser
        targetHandle: target
        type: custom
        zIndex: 0
      - data:
          priority: 0
          selected: false
          smooth: false
          sourceType: code
          targetType: code
          title: null
          type: custom
          zIndex: 0
        id: data_parser-calculation_node
        selected: false
        source: data_parser
        sourceHandle: source
        target: calculation_node
        targetHandle: target
        type: custom
        zIndex: 0
      - data:
          priority: 0
          selected: false
          smooth: false
          sourceType: code
          targetType: if-else
          title: null
          type: custom
          zIndex: 0
        id: calculation_node-order_validation
        selected: false
        source: calculation_node
        sourceHandle: source
        target: order_validation
        targetHandle: target
        type: custom
        zIndex: 0
      - data:
          priority: 0
          selected: false
          smooth: false
          sourceType: if-else
          targetType: llm
          title: null
          type: custom
          zIndex: 0
        id: order_validation-high_value_order-sufficient_stock_high_value
        selected: false
        source: order_validation
        sourceHandle: sufficient_stock_high_value
        target: high_value_order
        targetHandle: target
        type: custom
        zIndex: 0
      - data:
          priority: 0
          selected: false
          smooth: false
          sourceType: if-else
          targetType: llm
          title: null
          type: custom
          zIndex: 0
        id: order_validation-normal_order-sufficient_stock_normal_value
        selected: false
        source: order_validation
        sourceHandle: sufficient_stock_normal_value
        target: normal_order
        targetHandle: target
        type: custom
        zIndex: 0
      - data:
          priority: 0
          selected: false
          smooth: false
          sourceType: if-else
          targetType: llm
          title: null
          type: custom
          zIndex: 0
        id: order_validation-insufficient_stock-false
        selected: false
        source: order_validation
        sourceHandle: 'false'
        target: insufficient_stock
        targetHandle: target
        type: custom
        zIndex: 0
      - data:
          priority: 0
          selected: false
          smooth: false
          sourceType: llm
          targetType: answer
          title: null
          type: custom
          zIndex: 0
        id: high_value_order-answer_1
        selected: false
        source: high_value_order
        sourceHandle: source
        target: answer_1
        targetHandle: target
        type: custom
        zIndex: 0
      - data:
          priority: 0
          selected: false
          smooth: false
          sourceType: llm
          targetType: answer
          title: null
          type: custom
          zIndex: 0
        id: normal_order-answer_2
        selected: false
        source: normal_order
        sourceHandle: source
        target: answer_2
        targetHandle: target
        type: custom
        zIndex: 0
      - data:
          priority: 0
          selected: false
          smooth: false
          sourceType: llm
          targetType: answer
          title: null
          type: custom
          zIndex: 0
        id: insufficient_stock-answer_3
        selected: false
        source: insufficient_stock
        sourceHandle: source
        target: answer_3
        targetHandle: target
        type: custom
        zIndex: 0
    nodes:
      - data:
          desc: ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‹ã‚‰ã®å…¥åŠ›ã‚’å—ã‘å–ã‚‹
          selected: false
          title: é–‹å§‹
          type: start
          variables: []
        height: 90
        id: start
        position:
          x: 80
          y: 282
        positionAbsolute:
          x: 80
          y: 282
        selected: false
        sourcePosition: right
        targetPosition: left
        type: custom
        width: 244
      - data:
          code: "def main():\n    product_name = sys.query.get('å•†å“å', '')\n    quantity_str = sys.query.get('æ³¨æ–‡æ•°é‡', '0')\n    price_str = sys.query.get('å˜ä¾¡', '0')\n    \n    try:\n        quantity = int(quantity_str)\n        price = float(price_str)\n    except:\n        quantity = 0\n        price = 0\n    \n    return {\n        'product_name': product_name,\n        'quantity': quantity,\n        'price': price,\n        'stock_limit': 100\n    }"
          code_language: python3
          desc: å…¥åŠ›ãƒ‡ãƒ¼ã‚¿ã‚’è§£æ
          outputs:
            product_name:
              type: string
            quantity:
              type: number
            price:
              type: number
            stock_limit:
              type: number
          selected: false
          title: ãƒ‡ãƒ¼ã‚¿è§£æ
          type: code
          variables:
            - value_selector:
                - sys
                - query
              variable: sys.query
        height: 106
        id: data_parser
        position:
          x: 384
          y: 274
        positionAbsolute:
          x: 384
          y: 274
        selected: false
        sourcePosition: right
        targetPosition: left
        type: custom
        width: 244
      - data:
          code: "def main():\n    quantity = data_parser.get('quantity', 0)\n    price = data_parser.get('price', 0)\n    \n    total_amount = quantity * price\n    \n    return {\n        'total_amount': total_amount\n    }"
          code_language: python3
          desc: æ³¨æ–‡é‡‘é¡ã‚’è¨ˆç®—
          outputs:
            total_amount:
              type: number
          selected: false
          title: é‡‘é¡è¨ˆç®—
          type: code
          variables:
            - value_selector:
                - data_parser
              variable: data_parser
        height: 106
        id: calculation_node
        position:
          x: 688
          y: 274
        positionAbsolute:
          x: 688
          y: 274
        selected: false
        sourcePosition: right
        targetPosition: left
        type: custom
        width: 244
      - data:
          cases:
            - case_id: sufficient_stock_high_value
              id: sufficient_stock_high_value
              conditions:
                - id: stock_check_1
                  variable_selector:
                    - data_parser
                    - quantity
                  comparison_operator: "<="
                  value: 100
                - id: amount_check_1
                  variable_selector:
                    - calculation_node
                    - total_amount
                  comparison_operator: ">="
                  value: 10000
              logical_operator: and
            - case_id: sufficient_stock_normal_value
              id: sufficient_stock_normal_value
              conditions:
                - id: stock_check_2
                  variable_selector:
                    - data_parser
                    - quantity
                  comparison_operator: "<="
                  value: 100
                - id: amount_check_2
                  variable_selector:
                    - calculation_node
                    - total_amount
                  comparison_operator: "<"
                  value: 10000
              logical_operator: and
          desc: åœ¨åº«ã¨é‡‘é¡ã§æ³¨æ–‡ã‚’åˆ†é¡
          selected: false
          title: æ³¨æ–‡æ¤œè¨¼
          type: if-else
        height: 202
        id: order_validation
        position:
          x: 992
          y: 225
        positionAbsolute:
          x: 992
          y: 225
        selected: false
        sourcePosition: right
        targetPosition: left
        type: custom
        width: 244
      - data:
          context:
            enabled: true
            variable_selector:
              - sys
              - context
          desc: é«˜é¡æ³¨æ–‡ã®å‡¦ç†
          model:
            completion_params:
              temperature: 0.5
            mode: chat
            name: gpt-4o-mini
            provider: openai
          prompt:
            - id: prompt_1
              role: system
              text: é«˜é¡æ³¨æ–‡ã®ç¢ºèªãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’ç”Ÿæˆã—ã¦ãã ã•ã„ã€‚
            - id: prompt_2
              role: user
              text: "å•†å“å: {{#data_parser.product_name#}}\næ³¨æ–‡æ•°é‡: {{#data_parser.quantity#}}\nå˜ä¾¡: {{#data_parser.price#}}\nåˆè¨ˆé‡‘é¡: {{#calculation_node.total_amount#}}\n\nã“ã‚Œã¯é«˜é¡æ³¨æ–‡ã§ã™ã€‚ç‰¹åˆ¥ãªå¯¾å¿œã‚’ã”æ¡ˆå†…ã—ã¾ã™ã€‚"
          selected: false
          title: é«˜é¡æ³¨æ–‡å‡¦ç†
          type: llm
          variables: []
          vision:
            enabled: false
        height: 122
        id: high_value_order
        position:
          x: 1296
          y: 80
        positionAbsolute:
          x: 1296
          y: 80
        selected: false
        sourcePosition: right
        targetPosition: left
        type: custom
        width: 244
      - data:
          context:
            enabled: true
            variable_selector:
              - sys
              - context
          desc: é€šå¸¸æ³¨æ–‡ã®å‡¦ç†
          model:
            completion_params:
              temperature: 0.5
            mode: chat
            name: gpt-4o-mini
            provider: openai
          prompt:
            - id: prompt_1
              role: system
              text: é€šå¸¸æ³¨æ–‡ã®ç¢ºèªãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’ç”Ÿæˆã—ã¦ãã ã•ã„ã€‚
            - id: prompt_2
              role: user
              text: "å•†å“å: {{#data_parser.product_name#}}\næ³¨æ–‡æ•°é‡: {{#data_parser.quantity#}}\nå˜ä¾¡: {{#data_parser.price#}}\nåˆè¨ˆé‡‘é¡: {{#calculation_node.total_amount#}}\n\né€šå¸¸ã®æ³¨æ–‡ã¨ã—ã¦å‡¦ç†ã„ãŸã—ã¾ã™ã€‚"
          selected: false
          title: é€šå¸¸æ³¨æ–‡å‡¦ç†
          type: llm
          variables: []
          vision:
            enabled: false
        height: 122
        id: normal_order
        position:
          x: 1296
          y: 250
        positionAbsolute:
          x: 1296
          y: 250
        selected: false
        sourcePosition: right
        targetPosition: left
        type: custom
        width: 244
      - data:
          context:
            enabled: true
            variable_selector:
              - sys
              - context
          desc: åœ¨åº«ä¸è¶³ã®å‡¦ç†
          model:
            completion_params:
              temperature: 0.5
            mode: chat
            name: gpt-4o-mini
            provider: openai
          prompt:
            - id: prompt_1
              role: system
              text: åœ¨åº«ä¸è¶³ã®ãŠçŸ¥ã‚‰ã›ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’ç”Ÿæˆã—ã¦ãã ã•ã„ã€‚
            - id: prompt_2
              role: user
              text: "å•†å“å: {{#data_parser.product_name#}}\næ³¨æ–‡æ•°é‡: {{#data_parser.quantity#}}\nåœ¨åº«æ•°: {{#data_parser.stock_limit#}}\n\nç”³ã—è¨³ã”ã–ã„ã¾ã›ã‚“ã€‚åœ¨åº«ãŒä¸è¶³ã—ã¦ãŠã‚Šã¾ã™ã€‚"
          selected: false
          title: åœ¨åº«ä¸è¶³å‡¦ç†
          type: llm
          variables: []
          vision:
            enabled: false
        height: 122
        id: insufficient_stock
        position:
          x: 1296
          y: 420
        positionAbsolute:
          x: 1296
          y: 420
        selected: false
        sourcePosition: right
        targetPosition: left
        type: custom
        width: 244
      - data:
          answer: '{{#high_value_order.text#}}'
          desc: é«˜é¡æ³¨æ–‡ã®å›ç­”
          selected: false
          title: å›ç­”1
          type: answer
          variables: []
        height: 90
        id: answer_1
        position:
          x: 1600
          y: 80
        positionAbsolute:
          x: 1600
          y: 80
        selected: false
        sourcePosition: right
        targetPosition: left
        type: custom
        width: 244
      - data:
          answer: '{{#normal_order.text#}}'
          desc: é€šå¸¸æ³¨æ–‡ã®å›ç­”
          selected: false
          title: å›ç­”2
          type: answer
          variables: []
        height: 90
        id: answer_2
        position:
          x: 1600
          y: 250
        positionAbsolute:
          x: 1600
          y: 250
        selected: false
        sourcePosition: right
        targetPosition: left
        type: custom
        width: 244
      - data:
          answer: '{{#insufficient_stock.text#}}'
          desc: åœ¨åº«ä¸è¶³ã®å›ç­”
          selected: false
          title: å›ç­”3
          type: answer
          variables: []
        height: 90
        id: answer_3
        position:
          x: 1600
          y: 420
        positionAbsolute:
          x: 1600
          y: 420
        selected: false
        sourcePosition: right
        targetPosition: left
        type: custom
        width: 244