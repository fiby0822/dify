app:
  description: "å–¶æ¥­ãƒãƒ¼ãƒ ã®æœˆé–“å£²ä¸Šãƒ‡ãƒ¼ã‚¿ã‚’Google Sheetsã‹ã‚‰å–å¾—ã—ã€åˆ†æçµæœã‚’åˆ¥ã‚·ãƒ¼ãƒˆã«å‡ºåŠ›ã™ã‚‹ãƒ„ãƒ¼ãƒ«ã§ã™ã€‚å£²ä¸Šåˆè¨ˆã€å¹³å‡ã€æœ€é«˜ãƒ»æœ€ä½å£²ä¸Šã€TOP3å–¶æ¥­æ‹…å½“è€…ã‚’è‡ªå‹•çš„ã«è¨ˆç®—ã—ã¾ã™ã€‚"
  icon: "ğŸ“Š"
  icon_background: "#E8F4FD"
  mode: advanced-chat
  name: "å–¶æ¥­ãƒ‡ãƒ¼ã‚¿åˆ†æãƒ„ãƒ¼ãƒ«"
  use_icon_as_answer_icon: false

dependencies:
  - name: "@langgenius/google-sheets"
    value:
      version: "1.0.0"

kind: app
version: 0.3.0

workflow:
  conversation_variables: []
  environment_variables: []
  features:
    file_upload:
      allowed_extensions: []
      allowed_file_types: []
      enabled: false
      max_files: 5
    opening_statement: |
      å–¶æ¥­ãƒ‡ãƒ¼ã‚¿åˆ†æãƒ„ãƒ¼ãƒ«ã¸ã‚ˆã†ã“ãï¼

      ã“ã®ãƒ„ãƒ¼ãƒ«ã¯ã€Google Sheetsã®å–¶æ¥­ãƒ‡ãƒ¼ã‚¿ã‚’è‡ªå‹•çš„ã«åˆ†æã—ã¾ã™ã€‚
      ä»¥ä¸‹ã®å‡¦ç†ã‚’å®Ÿè¡Œã—ã¾ã™ï¼š
      1. ã€Œå£²ä¸Šãƒ‡ãƒ¼ã‚¿!A1:C50ã€ã‹ã‚‰å–¶æ¥­ãƒ‡ãƒ¼ã‚¿ã‚’å–å¾—
      2. å£²ä¸Šåˆè¨ˆã€å¹³å‡ã€æœ€é«˜ãƒ»æœ€ä½å£²ä¸Šã‚’è¨ˆç®—
      3. å£²ä¸ŠTOP3ã®å–¶æ¥­æ‹…å½“è€…ã‚’ç‰¹å®š
      4. åˆ†æçµæœã‚’ã€Œåˆ†æçµæœ!A1:B10ã€ã«å‡ºåŠ›

      ã€Œé–‹å§‹ã€ã¨å…¥åŠ›ã—ã¦ãã ã•ã„ã€‚
    retriever_resource:
      enabled: false
    sensitive_word_avoidance:
      enabled: false
    speech_to_text:
      enabled: false
    suggested_questions:
      - "é–‹å§‹"
      - "å–¶æ¥­ãƒ‡ãƒ¼ã‚¿ã‚’åˆ†æã—ã¦"
      - "å£²ä¸Šãƒ‡ãƒ¼ã‚¿ã®åˆ†æã‚’å®Ÿè¡Œ"
    suggested_questions_after_answer:
      enabled: false
    text_to_speech:
      enabled: false
      language: ""
      voice: ""
  graph:
    edges:
      - data:
          isInLoop: false
          priority: 1
          sourceType: start
          targetType: tool
        id: edge_start_to_read
        selected: false
        source: start_node
        sourceHandle: source
        target: google_sheets_read
        targetHandle: target
        type: custom
        zIndex: 0
      - data:
          isInLoop: false
          priority: 1
          sourceType: tool
          targetType: template-transform
        id: edge_read_to_transform
        selected: false
        source: google_sheets_read
        sourceHandle: source
        target: data_formatter
        targetHandle: target
        type: custom
        zIndex: 0
      - data:
          isInLoop: false
          priority: 1
          sourceType: template-transform
          targetType: llm
        id: edge_transform_to_llm
        selected: false
        source: data_formatter
        sourceHandle: source
        target: data_analyzer
        targetHandle: target
        type: custom
        zIndex: 0
      - data:
          isInLoop: false
          priority: 1
          sourceType: llm
          targetType: template-transform
        id: edge_llm_to_prepare
        selected: false
        source: data_analyzer
        sourceHandle: source
        target: result_formatter
        targetHandle: target
        type: custom
        zIndex: 0
      - data:
          isInLoop: false
          priority: 1
          sourceType: template-transform
          targetType: tool
        id: edge_prepare_to_write
        selected: false
        source: result_formatter
        sourceHandle: source
        target: google_sheets_write
        targetHandle: target
        type: custom
        zIndex: 0
      - data:
          isInLoop: false
          priority: 1
          sourceType: tool
          targetType: answer
        id: edge_write_to_answer
        selected: false
        source: google_sheets_write
        sourceHandle: source
        target: answer_node
        targetHandle: target
        type: custom
        zIndex: 0
    nodes:
      - data:
          desc: "ãƒãƒ£ãƒƒãƒˆé–‹å§‹ãƒãƒ¼ãƒ‰"
          selected: false
          title: "é–‹å§‹"
          type: start
          variables: []
        height: 90
        id: start_node
        position:
          x: 50
          y: 200
        positionAbsolute:
          x: 50
          y: 200
        selected: false
        sourcePosition: right
        targetPosition: left
        type: custom
        width: 244
      - data:
          desc: "Google Sheetsã‹ã‚‰å–¶æ¥­ãƒ‡ãƒ¼ã‚¿ã‚’å–å¾—"
          provider_id: "@langgenius/google-sheets"
          provider_name: "Google Sheets"
          provider_type: marketplace
          selected: false
          title: "å–¶æ¥­ãƒ‡ãƒ¼ã‚¿å–å¾—"
          tool_label: "Google Sheets"
          tool_name: batch_get
          tool_parameters:
            ranges:
              type: mixed
              value: '["å£²ä¸Šãƒ‡ãƒ¼ã‚¿!A1:C50"]'
            spreadsheet_id:
              type: mixed
              value: "1dd5IPZBYY5ZtImb48SLnO8c9b4Z8w5YUr1gWF0STqSQ"
          type: tool
        height: 146
        id: google_sheets_read
        position:
          x: 350
          y: 200
        positionAbsolute:
          x: 350
          y: 200
        selected: false
        sourcePosition: right
        targetPosition: left
        type: custom
        width: 244
      - data:
          desc: "å–å¾—ãƒ‡ãƒ¼ã‚¿ã‚’CSVå½¢å¼ã«å¤‰æ›"
          template: |
            å–å¾—ã—ãŸå–¶æ¥­ãƒ‡ãƒ¼ã‚¿ï¼š
            {{data | tojson}}
          title: "ãƒ‡ãƒ¼ã‚¿æ•´å½¢"
          type: template-transform
          variables:
            - variable: data
              value_selector: [google_sheets_read, text]
              value_type: string
        height: 54
        id: data_formatter
        position:
          x: 650
          y: 200
        positionAbsolute:
          x: 650
          y: 200
        selected: false
        sourcePosition: right
        targetPosition: left
        type: custom
        width: 244
      - data:
          completion_params:
            max_tokens: 1500
            temperature: 0.2
          context:
            enabled: false
            variable_selector: []
          desc: "å–¶æ¥­ãƒ‡ãƒ¼ã‚¿ã‚’åˆ†æ"
          model:
            mode: chat
            name: gpt-4o
            provider: openai
          prompt_template:
            - id: system-prompt-1
              role: system
              text: |
                ã‚ãªãŸã¯å„ªç§€ãªãƒ‡ãƒ¼ã‚¿ã‚¢ãƒŠãƒªã‚¹ãƒˆã§ã™ã€‚
                å–¶æ¥­ãƒ‡ãƒ¼ã‚¿ã‚’åˆ†æã—ã€ä»¥ä¸‹ã®å½¢å¼ã§çµæœã‚’å‡ºåŠ›ã—ã¦ãã ã•ã„ã€‚

                å‡ºåŠ›å½¢å¼ï¼ˆJSONå½¢å¼ï¼‰ï¼š
                {
                  "åˆè¨ˆå£²ä¸Š": "æ•°å€¤",
                  "å¹³å‡å£²ä¸Š": "æ•°å€¤",
                  "æœ€é«˜å£²ä¸Š": "æ•°å€¤",
                  "æœ€ä½å£²ä¸Š": "æ•°å€¤",
                  "TOP1": "å–¶æ¥­æ‹…å½“è€…åï¼ˆå£²ä¸Šé‡‘é¡ï¼‰",
                  "TOP2": "å–¶æ¥­æ‹…å½“è€…åï¼ˆå£²ä¸Šé‡‘é¡ï¼‰",
                  "TOP3": "å–¶æ¥­æ‹…å½“è€…åï¼ˆå£²ä¸Šé‡‘é¡ï¼‰"
                }

                æ³¨æ„äº‹é …ï¼š
                - å£²ä¸Šé‡‘é¡ã¯æ•°å€¤ã®ã¿ï¼ˆå††è¨˜å·ãªã—ï¼‰
                - TOP3ã¯å£²ä¸Šé¡ã®é™é †
                - å–¶æ¥­æ‹…å½“è€…åã¨å£²ä¸Šé‡‘é¡ã¯ã€Œåå‰ï¼ˆé‡‘é¡ï¼‰ã€å½¢å¼
            - id: user-prompt-1
              role: user
              text: |
                ä»¥ä¸‹ã®å–¶æ¥­ãƒ‡ãƒ¼ã‚¿ã‚’åˆ†æã—ã¦ãã ã•ã„ï¼š
                {{#data_formatter.output#}}
          selected: false
          structured_output_enabled: false
          title: "ãƒ‡ãƒ¼ã‚¿åˆ†æ"
          type: llm
          variables: []
          vision:
            enabled: false
        height: 98
        id: data_analyzer
        position:
          x: 950
          y: 200
        positionAbsolute:
          x: 950
          y: 200
        selected: false
        sourcePosition: right
        targetPosition: left
        type: custom
        width: 244
      - data:
          desc: "åˆ†æçµæœã‚’Google Sheetsç”¨ã«æ•´å½¢"
          template: |
            [
              {
                "range": "åˆ†æçµæœ!A1:B10",
                "values": [
                  ["é …ç›®", "å€¤"],
                  ["åˆè¨ˆå£²ä¸Š", "{{result.åˆè¨ˆå£²ä¸Š}}"],
                  ["å¹³å‡å£²ä¸Š", "{{result.å¹³å‡å£²ä¸Š}}"],
                  ["æœ€é«˜å£²ä¸Š", "{{result.æœ€é«˜å£²ä¸Š}}"],
                  ["æœ€ä½å£²ä¸Š", "{{result.æœ€ä½å£²ä¸Š}}"],
                  ["", ""],
                  ["é †ä½", "å–¶æ¥­æ‹…å½“è€…ï¼ˆå£²ä¸Šï¼‰"],
                  ["TOP1", "{{result.TOP1}}"],
                  ["TOP2", "{{result.TOP2}}"],
                  ["TOP3", "{{result.TOP3}}"]
                ]
              }
            ]
          title: "çµæœæ•´å½¢"
          type: template-transform
          variables:
            - variable: result
              value_selector: [data_analyzer, text]
              value_type: string
        height: 54
        id: result_formatter
        position:
          x: 1250
          y: 200
        positionAbsolute:
          x: 1250
          y: 200
        selected: false
        sourcePosition: right
        targetPosition: left
        type: custom
        width: 244
      - data:
          desc: "åˆ†æçµæœã‚’Google Sheetsã«æ›¸ãè¾¼ã¿"
          provider_id: "@langgenius/google-sheets"
          provider_name: "Google Sheets"
          provider_type: marketplace
          selected: false
          title: "çµæœæ›¸ãè¾¼ã¿"
          tool_label: "Google Sheets"
          tool_name: batch_update
          tool_parameters:
            data:
              type: mixed
              value: '{{#result_formatter.output#}}'
            spreadsheet_id:
              type: mixed
              value: "1dd5IPZBYY5ZtImb48SLnO8c9b4Z8w5YUr1gWF0STqSQ"
            value_input_option:
              type: mixed
              value: "USER_ENTERED"
          type: tool
        height: 146
        id: google_sheets_write
        position:
          x: 1550
          y: 200
        positionAbsolute:
          x: 1550
          y: 200
        selected: false
        sourcePosition: right
        targetPosition: left
        type: custom
        width: 244
      - data:
          answer: |
            å–¶æ¥­ãƒ‡ãƒ¼ã‚¿ã®åˆ†æãŒå®Œäº†ã—ã¾ã—ãŸï¼

            åˆ†æçµæœã¯ã€Œåˆ†æçµæœ!A1:B10ã€ã«å‡ºåŠ›ã•ã‚Œã¾ã—ãŸã€‚
            ä»¥ä¸‹ã®æƒ…å ±ãŒè¨˜éŒ²ã•ã‚Œã¦ã„ã¾ã™ï¼š

            - å£²ä¸Šåˆè¨ˆ
            - å¹³å‡å£²ä¸Š
            - æœ€é«˜å£²ä¸Šã¨æœ€ä½å£²ä¸Š
            - å£²ä¸ŠTOP3ã®å–¶æ¥­æ‹…å½“è€…

            Google Sheetsã§ã”ç¢ºèªãã ã•ã„ã€‚
          desc: "å®Œäº†ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸"
          selected: false
          title: "å®Œäº†"
          type: answer
          variables: []
        height: 107
        id: answer_node
        position:
          x: 1850
          y: 200
        positionAbsolute:
          x: 1850
          y: 200
        selected: false
        sourcePosition: right
        targetPosition: left
        type: custom
        width: 244
    viewport:
      x: 0
      y: 0
      zoom: 0.8