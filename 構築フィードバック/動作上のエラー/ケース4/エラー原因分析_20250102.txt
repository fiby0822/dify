# ケース4（ai_trend_search_2935.yml）のエラー原因分析

## エラー概要
Toolノードの必須フィールド欠落とパラメータ形式の誤り

## 具体的なエラー原因

### 1. 必須フィールドの欠落
- `provider_name`フィールドが存在しない（必須）
- `tool_label`フィールドが存在しない（必須）

### 2. tool_parametersの形式エラー
現在の記述：
```yaml
tool_parameters:
  query:
    type: mixed
    value: '{{#sys.query#}}'
  search_depth: basic   # ❌ 文字列直接指定
  topic: general        # ❌ 文字列直接指定
  time_range: week      # ❌ 文字列直接指定
  max_results: 5        # ❌ 数値直接指定
  include_answer: false # ❌ 真偽値直接指定
  include_images: false # ❌ 真偽値直接指定
  include_raw_content: false # ❌ 真偽値直接指定
```

### 3. エラーパターンの総括
4つのケースすべてで同じエラーパターン：
1. provider_name、tool_labelの欠落
2. tool_parametersに全パラメータを直接値で記載
3. tool_configurationsセクションの欠落または不適切な使用

### 4. 根本原因
- コーディングルールが実際の動作環境の要件と乖離
- ルールに従って作成してもエラーが発生する状況

## 結論
現在のコーディングルールは、Difyの最新仕様に対応していない。特にtoolノードの記述方法について、大幅な見直しが必要。