# NewsSearch_4732.yml エラー原因分析

## エラー内容
モデルの最大コンテキスト長（8192トークン）を超過
- リクエスト総トークン数：8389
- メッセージトークン数：6889
- 完了トークン数：1500

## エラー原因
LLMノード（summarize_node）でのトークン制限超過が原因です。

### 具体的な問題点
1. **検索結果のサイズ**
   - Tavily Searchで取得した検索結果（{{#web_search_node.text#}}）が大量のテキストを含む
   - max_results: 5でも、各結果に含まれる内容が多い可能性

2. **プロンプトの長さ**
   - システムプロンプトとユーザープロンプトを合わせると、基本的なテキスト量が多い
   - 検索結果を含めると、容易にコンテキスト制限を超過

3. **max_tokensの設定**
   - max_tokens: 1500は適切な設定だが、入力トークンが多すぎるため問題となっている

## 正常動作ファイルとの比較
### 製品レビュー調査ツール_3067.yml
- max_tokens: 2000（より大きい値）でも正常動作
- 違いは入力データのサイズにある可能性が高い

### 検索テスト.yml
- 検索結果を直接answerノードに渡している（LLM処理なし）
- トークン制限の問題を回避

## 根本原因
gpt-4モデル（8192トークン制限）に対して、検索結果が大きすぎることが根本原因。
検索結果のサイズを制御する仕組みが不足している。