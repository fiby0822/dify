app:
  description: é¡§å®¢ã‹ã‚‰ã®å•ã„åˆã‚ã›ã‚’å•†å“ä»•æ§˜ã¨åœ¨åº«çŠ¶æ³ã«åˆ†é¡ã—ã€ãã‚Œãã‚Œã«å¿œã˜ãŸé¡§å®¢å‘ã‘ãƒ»ãƒ¡ãƒ¼ã‚«ãƒ¼å‘ã‘ã®å®šå‹æ–‡ã‚’è‡ªå‹•ç”Ÿæˆã™ã‚‹ã‚·ã‚¹ãƒ†ãƒ ã§ã™ã€‚
  icon: ğŸ“§
  icon_background: "#4A90E2"
  mode: advanced-chat
  name: ã‚·ãƒ³ãƒ—ãƒ«åˆ†å²å‹å•ã„åˆã‚ã›å¯¾å¿œã‚·ã‚¹ãƒ†ãƒ 
  use_icon_as_answer_icon: false
kind: app
version: 0.3.0
workflow:
  conversation_variables: []
  environment_variables: []
  features:
    file_upload:
      allowed_file_extensions:
        - .PDF
        - .TXT
        - .CSV
      allowed_file_types:
        - document
      allowed_file_upload_methods:
        - local_file
      enabled: true
      number_limits: 3
    opening_statement: |
      å•ã„åˆã‚ã›å¯¾å¿œã‚·ã‚¹ãƒ†ãƒ ã¸ã‚ˆã†ã“ãï¼
      
      ã“ã®ã‚·ã‚¹ãƒ†ãƒ ã¯ã€é¡§å®¢ã‹ã‚‰ã®å•ã„åˆã‚ã›å†…å®¹ã‚’åˆ†æã—ã€ä»¥ä¸‹ã®2ã¤ã®ã‚¿ã‚¤ãƒ—ã«åˆ†é¡ã—ã¦é©åˆ‡ãªè¿”ä¿¡æ–‡ã‚’ç”Ÿæˆã—ã¾ã™ï¼š
      
      1. å•†å“ä»•æ§˜ã«é–¢ã™ã‚‹å•ã„åˆã‚ã›
      2. åœ¨åº«çŠ¶æ³ã«é–¢ã™ã‚‹å•ã„åˆã‚ã›
      
      ã€å…¥åŠ›é …ç›®ã€‘
      - å•ã„åˆã‚ã›å†…å®¹ï¼šé¡§å®¢ã‹ã‚‰ã®è³ªå•ã‚„è¦æœ›
      - é¡§å®¢æƒ…å ±ï¼šä¼šç¤¾åã€æ‹…å½“è€…åãªã©
      - å•†å“æƒ…å ±ï¼šå•†å“åã€å‹ç•ªãªã©
      
      ãã‚Œãã‚Œã®å•ã„åˆã‚ã›ã«å¯¾ã—ã¦ã€é¡§å®¢å‘ã‘ã¨ãƒ¡ãƒ¼ã‚«ãƒ¼å‘ã‘ã®æ–‡ç« ã‚’è‡ªå‹•ç”Ÿæˆã—ã¾ã™ã€‚
    retriever_resource:
      enabled: false
    sensitive_word_avoidance:
      enabled: false
    speech_to_text:
      enabled: false
    suggested_questions:
      - å•†å“ã®ä»•æ§˜ã«ã¤ã„ã¦æ•™ãˆã¦ãã ã•ã„
      - åœ¨åº«çŠ¶æ³ã‚’ç¢ºèªã—ãŸã„ã§ã™
      - å•†å“ã®ã‚µã‚¤ã‚ºã¨æ©Ÿèƒ½ã‚’çŸ¥ã‚ŠãŸã„ã§ã™
      - ç´æœŸã¯ã„ã¤ã«ãªã‚Šã¾ã™ã‹
    suggested_questions_after_answer:
      enabled: false
    text_to_speech:
      enabled: false
      language: ""
      voice: ""
  graph:
    edges:
      - data:
          isInIteration: false
          targetHandle: target
        id: start-classification-edge
        source: start_node
        sourceHandle: source
        target: inquiry_classification_node
        type: custom
      - data:
          isInIteration: false
          sourceHandle: "true"
          targetHandle: target
        id: classification-spec-edge
        source: inquiry_classification_node
        sourceHandle: "true"
        target: product_spec_response_node
        type: custom
      - data:
          isInIteration: false
          sourceHandle: "false"
          targetHandle: target
        id: classification-stock-edge
        source: inquiry_classification_node
        sourceHandle: "false"
        target: stock_status_response_node
        type: custom
      - data:
          isInIteration: false
          targetHandle: target
        id: spec-integration-edge
        source: product_spec_response_node
        sourceHandle: source
        target: response_integration_node
        type: custom
      - data:
          isInIteration: false
          targetHandle: target
        id: stock-integration-edge
        source: stock_status_response_node
        sourceHandle: source
        target: response_integration_node
        type: custom
      - data:
          isInIteration: false
          targetHandle: target
        id: integration-answer-edge
        source: response_integration_node
        sourceHandle: source
        target: answer_node
        type: custom
    nodes:
      - data:
          desc: ""
          selected: false
          title: é–‹å§‹
          type: start
          variables:
            - label: å•ã„åˆã‚ã›å†…å®¹
              max_length: 1000
              options: []
              required: true
              type: paragraph
              variable: inquiry_content
            - label: é¡§å®¢æƒ…å ±
              max_length: 500
              options: []
              required: true
              type: text-input
              variable: customer_info
            - label: å•†å“æƒ…å ±
              max_length: 500
              options: []
              required: true
              type: text-input
              variable: product_info
        height: 188
        id: start_node
        position:
          x: 50
          y: 282
        positionAbsolute:
          x: 50
          y: 282
        selected: false
        sourcePosition: right
        targetPosition: left
        type: start
        width: 244
      - data:
          cases:
            - case_id: "true"
              conditions:
                - comparison_operator: contains
                  id: "1"
                  value: ä»•æ§˜
                  value_type: string
                  variable_selector:
                    - start_node
                    - inquiry_content
                - comparison_operator: contains
                  id: "2"
                  value: æ€§èƒ½
                  value_type: string
                  variable_selector:
                    - start_node
                    - inquiry_content
                - comparison_operator: contains
                  id: "3"
                  value: ã‚µã‚¤ã‚º
                  value_type: string
                  variable_selector:
                    - start_node
                    - inquiry_content
                - comparison_operator: contains
                  id: "4"
                  value: æ©Ÿèƒ½
                  value_type: string
                  variable_selector:
                    - start_node
                    - inquiry_content
                - comparison_operator: contains
                  id: "5"
                  value: ä½¿ã„æ–¹
                  value_type: string
                  variable_selector:
                    - start_node
                    - inquiry_content
              id: "true"
              logical_operator: or
          desc: å•ã„åˆã‚ã›å†…å®¹ã‹ã‚‰å•†å“ä»•æ§˜ã‹åœ¨åº«çŠ¶æ³ã‹ã‚’åˆ¤å®š
          selected: false
          title: å•ã„åˆã‚ã›ç¨®åˆ¥åˆ¤å®š
          type: if-else
        height: 134
        id: inquiry_classification_node
        position:
          x: 350
          y: 282
        positionAbsolute:
          x: 350
          y: 282
        selected: false
        sourcePosition: right
        targetPosition: left
        type: if-else
        width: 244
      - data:
          context:
            enabled: false
            variable_selector: []
          desc: å•†å“ä»•æ§˜ã«é–¢ã™ã‚‹å•ã„åˆã‚ã›ã¸ã®å¯¾å¿œæ–‡ç« ç”Ÿæˆ
          memory:
            role_prefix:
              assistant: ""
              user: ""
            window:
              enabled: false
              size: 10
          model:
            completion_params:
              temperature: 0.7
            mode: chat
            name: gpt-4o-mini
            provider: openai
          prompt_template:
            - id: system_prompt
              role: system
              text: |
                ã‚ãªãŸã¯å•ã„åˆã‚ã›å¯¾å¿œã®å°‚é–€å®¶ã§ã™ã€‚å•†å“ä»•æ§˜ã«é–¢ã™ã‚‹å•ã„åˆã‚ã›ã«å¯¾ã—ã¦ã€ä»¥ä¸‹ã®2ç¨®é¡ã®æ–‡ç« ã‚’ç”Ÿæˆã—ã¦ãã ã•ã„ï¼š
                
                1. é¡§å®¢å‘ã‘æ–‡ç« ï¼šä¸å¯§ã§åˆ†ã‹ã‚Šã‚„ã™ãã€å•†å“ä»•æ§˜ã«ã¤ã„ã¦ç¢ºèªä¸­ã§ã‚ã‚‹ã“ã¨ã‚’ä¼ãˆã‚‹
                2. ãƒ¡ãƒ¼ã‚«ãƒ¼å‘ã‘æ–‡ç« ï¼šæŠ€è¡“çš„ãªè©³ç´°ã‚’ç¢ºèªã™ã‚‹ãŸã‚ã®å…·ä½“çš„ãªè³ªå•
                
                å‡ºåŠ›å½¢å¼ï¼š
                ã€é¡§å®¢å‘ã‘æ–‡ç« ã€‘
                ï¼ˆã“ã“ã«é¡§å®¢å‘ã‘ã®æ–‡ç« ï¼‰
                
                ã€ãƒ¡ãƒ¼ã‚«ãƒ¼å‘ã‘æ–‡ç« ã€‘
                ï¼ˆã“ã“ã«ãƒ¡ãƒ¼ã‚«ãƒ¼å‘ã‘ã®æ–‡ç« ï¼‰
            - id: user_prompt
              role: user
              text: |
                å•ã„åˆã‚ã›å†…å®¹ï¼š{{#start_node.inquiry_content#}}
                é¡§å®¢æƒ…å ±ï¼š{{#start_node.customer_info#}}
                å•†å“æƒ…å ±ï¼š{{#start_node.product_info#}}
          selected: false
          title: å•†å“ä»•æ§˜å¯¾å¿œæ–‡ç« ç”Ÿæˆ
          type: llm
          variables: []
          vision:
            enabled: false
        height: 98
        id: product_spec_response_node
        position:
          x: 650
          y: 182
        positionAbsolute:
          x: 650
          y: 182
        selected: false
        sourcePosition: right
        targetPosition: left
        type: llm
        width: 244
      - data:
          context:
            enabled: false
            variable_selector: []
          desc: åœ¨åº«çŠ¶æ³ã«é–¢ã™ã‚‹å•ã„åˆã‚ã›ã¸ã®å¯¾å¿œæ–‡ç« ç”Ÿæˆ
          memory:
            role_prefix:
              assistant: ""
              user: ""
            window:
              enabled: false
              size: 10
          model:
            completion_params:
              temperature: 0.7
            mode: chat
            name: gpt-4o-mini
            provider: openai
          prompt_template:
            - id: system_prompt
              role: system
              text: |
                ã‚ãªãŸã¯å•ã„åˆã‚ã›å¯¾å¿œã®å°‚é–€å®¶ã§ã™ã€‚åœ¨åº«çŠ¶æ³ã«é–¢ã™ã‚‹å•ã„åˆã‚ã›ã«å¯¾ã—ã¦ã€ä»¥ä¸‹ã®2ç¨®é¡ã®æ–‡ç« ã‚’ç”Ÿæˆã—ã¦ãã ã•ã„ï¼š
                
                1. é¡§å®¢å‘ã‘æ–‡ç« ï¼šåœ¨åº«ç¢ºèªä¸­ã§ã‚ã‚‹ã“ã¨ã‚’ä¸å¯§ã«ä¼ãˆã€å›ç­”äºˆå®šã‚’ç¤ºã™
                2. ãƒ¡ãƒ¼ã‚«ãƒ¼å‘ã‘æ–‡ç« ï¼šåœ¨åº«ç¢ºèªã¨ç´æœŸç…§ä¼šã‚’è¡Œã†ãŸã‚ã®å…·ä½“çš„ãªä¾é ¼
                
                å‡ºåŠ›å½¢å¼ï¼š
                ã€é¡§å®¢å‘ã‘æ–‡ç« ã€‘
                ï¼ˆã“ã“ã«é¡§å®¢å‘ã‘ã®æ–‡ç« ï¼‰
                
                ã€ãƒ¡ãƒ¼ã‚«ãƒ¼å‘ã‘æ–‡ç« ã€‘
                ï¼ˆã“ã“ã«ãƒ¡ãƒ¼ã‚«ãƒ¼å‘ã‘ã®æ–‡ç« ï¼‰
            - id: user_prompt
              role: user
              text: |
                å•ã„åˆã‚ã›å†…å®¹ï¼š{{#start_node.inquiry_content#}}
                é¡§å®¢æƒ…å ±ï¼š{{#start_node.customer_info#}}
                å•†å“æƒ…å ±ï¼š{{#start_node.product_info#}}
          selected: false
          title: åœ¨åº«çŠ¶æ³å¯¾å¿œæ–‡ç« ç”Ÿæˆ
          type: llm
          variables: []
          vision:
            enabled: false
        height: 98
        id: stock_status_response_node
        position:
          x: 650
          y: 382
        positionAbsolute:
          x: 650
          y: 382
        selected: false
        sourcePosition: right
        targetPosition: left
        type: llm
        width: 244
      - data:
          code: |
            def main(spec_response, stock_response, inquiry_type):
                # ã©ã¡ã‚‰ã‹ã®å¿œç­”ã‚’é¸æŠ
                if spec_response and spec_response.strip():
                    response = spec_response
                else:
                    response = stock_response
                
                # ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆèª¿æ•´
                formatted_response = f"""
            å•ã„åˆã‚ã›å¯¾å¿œæ–‡ç« 
            ====================
            
            {response}
            
            ====================
            å‡¦ç†å®Œäº†æ—¥æ™‚ï¼š{import_datetime_now()}
                """
                
                return {
                    "final_response": formatted_response.strip()
                }
            
            def import_datetime_now():
                import datetime
                return datetime.datetime.now().strftime("%Yå¹´%mæœˆ%dæ—¥ %H:%M:%S")
          code_language: python3
          desc: ç”Ÿæˆã•ã‚ŒãŸæ–‡ç« ã‚’çµ±åˆã—ã¦ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆèª¿æ•´
          outputs:
            final_response:
              children: null
              type: string
          selected: false
          title: æ–‡ç« çµ±åˆå‡¦ç†
          type: code
          variables:
            - value_selector:
                - product_spec_response_node
                - text
              variable: spec_response
            - value_selector:
                - stock_status_response_node
                - text
              variable: stock_response
            - value_selector:
                - inquiry_classification_node
                - result
              variable: inquiry_type
        height: 66
        id: response_integration_node
        position:
          x: 950
          y: 282
        positionAbsolute:
          x: 950
          y: 282
        selected: false
        sourcePosition: right
        targetPosition: left
        type: code
        width: 244
      - data:
          answer: "{{#response_integration_node.final_response#}}"
          desc: ""
          selected: false
          title: æœ€çµ‚å›ç­”
          type: answer
          variables: []
        height: 107
        id: answer_node
        position:
          x: 1250
          y: 282
        positionAbsolute:
          x: 1250
          y: 282
        selected: false
        sourcePosition: right
        targetPosition: left
        type: answer
        width: 244
  hash: "63a8f2b9c4e5d1a7"